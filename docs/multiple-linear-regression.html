<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 Multiple Linear Regression | Quantitive Methods 2, ZHAW</title>
  <meta name="description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  <meta name="generator" content="bookdown 0.41 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 Multiple Linear Regression | Quantitive Methods 2, ZHAW" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 Multiple Linear Regression | Quantitive Methods 2, ZHAW" />
  
  <meta name="twitter:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  

<meta name="author" content="Jürgen Degenfellner" />


<meta name="date" content="2025-01-31" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="simple-linear-regression.html"/>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<link href="libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<script src="libs/viz-1.8.2/viz.js"></script>
<link href="libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet" />
<script src="libs/grViz-binding-1.0.11/grViz.js"></script>
<script src="libs/plotly-binding-4.10.4/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-2.11.1/plotly-latest.min.js"></script>


<style type="text/css">
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Quantitative Methods 2</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#books-we-will-heavily-borrow-from-are"><i class="fa fa-check"></i><b>1.1</b> Books we will heavily borrow from are:</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#if-you-need-a-good-reason-to-buy-good-books"><i class="fa fa-check"></i><b>1.2</b> If you need a good reason to buy good books…</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> Introduction</a>
<ul>
<li class="chapter" data-level="2.1" data-path="intro.html"><a href="intro.html#what-is-statistical-modeling-and-what-do-we-need-this-for"><i class="fa fa-check"></i><b>2.1</b> What is statistical modeling and what do we need this for?</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="intro.html"><a href="intro.html#explanatory-vs.-predictive-models"><i class="fa fa-check"></i><b>2.1.1</b> Explanatory vs. Predictive Models</a></li>
<li class="chapter" data-level="2.1.2" data-path="intro.html"><a href="intro.html#individual-vs.-population-prediction"><i class="fa fa-check"></i><b>2.1.2</b> Individual vs. Population Prediction</a></li>
<li class="chapter" data-level="2.1.3" data-path="intro.html"><a href="intro.html#practical-use-of-statistical-models"><i class="fa fa-check"></i><b>2.1.3</b> Practical Use of Statistical Models</a></li>
<li class="chapter" data-level="2.1.4" data-path="intro.html"><a href="intro.html#start-at-the-beginning"><i class="fa fa-check"></i><b>2.1.4</b> Start at the beginning</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="intro.html"><a href="intro.html#a-simple-model-for-adult-body-heights-in-the-bayesian-framework"><i class="fa fa-check"></i><b>2.2</b> A (simple) model for adult body heights in the Bayesian framework</a></li>
<li class="chapter" data-level="2.3" data-path="intro.html"><a href="intro.html#classical-approach-for-the-simplest-model"><i class="fa fa-check"></i><b>2.3</b> Classical approach for the simplest model</a></li>
<li class="chapter" data-level="2.4" data-path="intro.html"><a href="intro.html#exercises"><i class="fa fa-check"></i><b>2.4</b> Exercises</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="intro.html"><a href="intro.html#exercise1_Intro"><i class="fa fa-check"></i><b>2.4.1</b> [E] Exercise 1</a></li>
<li class="chapter" data-level="2.4.2" data-path="intro.html"><a href="intro.html#exercise2_Intro"><i class="fa fa-check"></i><b>2.4.2</b> [E] Exercise 2</a></li>
<li class="chapter" data-level="2.4.3" data-path="intro.html"><a href="intro.html#exercise3_Intro"><i class="fa fa-check"></i><b>2.4.3</b> [M] Exercise 3</a></li>
<li class="chapter" data-level="2.4.4" data-path="intro.html"><a href="intro.html#exercise4_Intro"><i class="fa fa-check"></i><b>2.4.4</b> [M] Exercise 4</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="intro.html"><a href="intro.html#addendum"><i class="fa fa-check"></i><b>2.5</b> Addendum</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="intro.html"><a href="intro.html#bivariate_normal"><i class="fa fa-check"></i><b>2.5.1</b> The bivariate normal distribution</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html"><i class="fa fa-check"></i><b>3</b> Simple Linear Regression</a>
<ul>
<li class="chapter" data-level="3.1" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#simple-linear-regression-in-the-bayesian-framework"><i class="fa fa-check"></i><b>3.1</b> Simple Linear Regression in the Bayesian Framework</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#model-definition"><i class="fa fa-check"></i><b>3.1.1</b> Model definition</a></li>
<li class="chapter" data-level="3.1.2" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#priors"><i class="fa fa-check"></i><b>3.1.2</b> Priors</a></li>
<li class="chapter" data-level="3.1.3" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#fit-model"><i class="fa fa-check"></i><b>3.1.3</b> Fit model</a></li>
<li class="chapter" data-level="3.1.4" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#result"><i class="fa fa-check"></i><b>3.1.4</b> Result</a></li>
<li class="chapter" data-level="3.1.5" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#credible-bands"><i class="fa fa-check"></i><b>3.1.5</b> Credible bands</a></li>
<li class="chapter" data-level="3.1.6" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#summary"><i class="fa fa-check"></i><b>3.1.6</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#simple-linear-regression-in-the-frequentist-framework"><i class="fa fa-check"></i><b>3.2</b> Simple Linear Regression in the Frequentist Framework</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#model-definition-1"><i class="fa fa-check"></i><b>3.2.1</b> Model definition</a></li>
<li class="chapter" data-level="3.2.2" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#fit_model_simple_lin_reg_classic"><i class="fa fa-check"></i><b>3.2.2</b> Fit the model</a></li>
<li class="chapter" data-level="3.2.3" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#confidence_intervals_frequentist"><i class="fa fa-check"></i><b>3.2.3</b> Confidence Intervals of coefficients (frequentist)</a></li>
<li class="chapter" data-level="3.2.4" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#analysis_of_variance"><i class="fa fa-check"></i><b>3.2.4</b> ANOVA (Analysis of Variance)</a></li>
<li class="chapter" data-level="3.2.5" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#r2---coefficient-of-determination"><i class="fa fa-check"></i><b>3.2.5</b> <span class="math inline">\(R^2\)</span> - Coefficient of Determination</a></li>
<li class="chapter" data-level="3.2.6" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#check-regression-assumptions"><i class="fa fa-check"></i><b>3.2.6</b> Check regression assumptions</a></li>
<li class="chapter" data-level="3.2.7" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#bootstrap-fit"><i class="fa fa-check"></i><b>3.2.7</b> Bootstrap fit</a></li>
<li class="chapter" data-level="3.2.8" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#regression-towards-the-mean"><i class="fa fa-check"></i><b>3.2.8</b> Regression towards the mean</a></li>
<li class="chapter" data-level="3.2.9" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#random-x-vs-fixed-x"><i class="fa fa-check"></i><b>3.2.9</b> Random X vs fixed X</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#exercises-1"><i class="fa fa-check"></i><b>3.3</b> Exercises</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#exercise1_simpl_lin_reg"><i class="fa fa-check"></i><b>3.3.1</b> [E] Exercise 1</a></li>
<li class="chapter" data-level="3.3.2" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#exercise2_simpl_lin_reg"><i class="fa fa-check"></i><b>3.3.2</b> [E] Exercise 2</a></li>
<li class="chapter" data-level="3.3.3" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#exercise3_simpl_lin_reg"><i class="fa fa-check"></i><b>3.3.3</b> [M] Exercise 3</a></li>
<li class="chapter" data-level="3.3.4" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#exercise4_simpl_lin_reg"><i class="fa fa-check"></i><b>3.3.4</b> [M] Exercise 4</a></li>
<li class="chapter" data-level="3.3.5" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#exercise5_simpl_lin_reg"><i class="fa fa-check"></i><b>3.3.5</b> [M] Exercise 5</a></li>
<li class="chapter" data-level="3.3.6" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#exercise6_simpl_lin_reg"><i class="fa fa-check"></i><b>3.3.6</b> [H] Exercise 6</a></li>
<li class="chapter" data-level="3.3.7" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#exercise7_simpl_lin_reg"><i class="fa fa-check"></i><b>3.3.7</b> [M] Exercise 7</a></li>
<li class="chapter" data-level="3.3.8" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#exercise8_simpl_lin_reg"><i class="fa fa-check"></i><b>3.3.8</b> [H] Exercise 8</a></li>
<li class="chapter" data-level="3.3.9" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#exercise9_simpl_lin_reg"><i class="fa fa-check"></i><b>3.3.9</b> [M] Exercise 9</a></li>
<li class="chapter" data-level="3.3.10" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#exercise10_simpl_lin_reg"><i class="fa fa-check"></i><b>3.3.10</b> [M] Exercise 10</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="multiple-linear-regression.html"><a href="multiple-linear-regression.html"><i class="fa fa-check"></i><b>4</b> Multiple Linear Regression</a>
<ul>
<li class="chapter" data-level="4.1" data-path="multiple-linear-regression.html"><a href="multiple-linear-regression.html#linear-regression-with-two-predictors-in-the-baysian-framework"><i class="fa fa-check"></i><b>4.1</b> Linear Regression with Two Predictors in the Baysian Framework</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="multiple-linear-regression.html"><a href="multiple-linear-regression.html#meaning-of-linear"><i class="fa fa-check"></i><b>4.1.1</b> Meaning of “linear”</a></li>
<li class="chapter" data-level="4.1.2" data-path="multiple-linear-regression.html"><a href="multiple-linear-regression.html#adding_transformed_predictor"><i class="fa fa-check"></i><b>4.1.2</b> Adding a transformed predictor to the model</a></li>
<li class="chapter" data-level="4.1.3" data-path="multiple-linear-regression.html"><a href="multiple-linear-regression.html#adding-another-predictor-to-the-model"><i class="fa fa-check"></i><b>4.1.3</b> Adding another predictor to the model</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="multiple-linear-regression.html"><a href="multiple-linear-regression.html#linear-regression-with-two-predictors-in-the-frequentist-framework"><i class="fa fa-check"></i><b>4.2</b> Linear Regression with Two Predictors in the Frequentist Framework</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="multiple-linear-regression.html"><a href="multiple-linear-regression.html#adding-a-transformed-predictor-to-the-model"><i class="fa fa-check"></i><b>4.2.1</b> Adding a transformed predictor to the model</a></li>
<li class="chapter" data-level="4.2.2" data-path="multiple-linear-regression.html"><a href="multiple-linear-regression.html#adding-another-predictor-to-the-model-1"><i class="fa fa-check"></i><b>4.2.2</b> Adding another predictor to the model</a></li>
<li class="chapter" data-level="4.2.3" data-path="multiple-linear-regression.html"><a href="multiple-linear-regression.html#interaction-term-x_1-times-x_2"><i class="fa fa-check"></i><b>4.2.3</b> Interaction term <span class="math inline">\(X_1 \times X_2\)</span></a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="multiple-linear-regression.html"><a href="multiple-linear-regression.html#exercises-2"><i class="fa fa-check"></i><b>4.3</b> Exercises</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="multiple-linear-regression.html"><a href="multiple-linear-regression.html#exercise1_multiple_regression"><i class="fa fa-check"></i><b>4.3.1</b> [M] Exercise 1</a></li>
<li class="chapter" data-level="4.3.2" data-path="multiple-linear-regression.html"><a href="multiple-linear-regression.html#exercise2_multiple_regression"><i class="fa fa-check"></i><b>4.3.2</b> [E] Exercise 2</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="multiple-linear-regression.html"><a href="multiple-linear-regression.html#todos"><i class="fa fa-check"></i><b>4.4</b> TODOS</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Quantitive Methods 2, ZHAW</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="multiple-linear-regression" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number">Chapter 4</span> Multiple Linear Regression<a href="multiple-linear-regression.html#multiple-linear-regression" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>So far, we have dealt with the simple mean model and the model with one predictor
in the Bayesian and Frequentist framework.
We will now add another predictor and subsequently an interaction term to the model.</p>
<div id="linear-regression-with-two-predictors-in-the-baysian-framework" class="section level2 hasAnchor" number="4.1">
<h2><span class="header-section-number">4.1</span> Linear Regression with Two Predictors in the Baysian Framework<a href="multiple-linear-regression.html#linear-regression-with-two-predictors-in-the-baysian-framework" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="meaning-of-linear" class="section level3 hasAnchor" number="4.1.1">
<h3><span class="header-section-number">4.1.1</span> Meaning of “linear”<a href="multiple-linear-regression.html#meaning-of-linear" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>What is a linear model? The term “linear” refers to the relationship of the predictors
with the dependent variable (or outcome). The following model is also linear:</p>
<p><span class="math display">\[height_i = \beta_0 + \beta_1 x_i + \beta_2 x_i^2\]</span></p>
<p>The model is linear in the parameters <span class="math inline">\(\beta_0, \beta_1, \beta_2\)</span> but not in the predictors <span class="math inline">\(x_i\)</span>.
The term <span class="math inline">\(x_i^2\)</span> is ok, since the heights are just sums of multiples of the predictors (which can be nonlinear).
This model is not a linear model anymore:</p>
<p><span class="math display">\[height_i = \beta_0 + \beta_1 x_i + e^{\beta_2 x_i^2}\]</span></p>
<p><span class="math inline">\(\beta_2\)</span> is now is the exponent of <span class="math inline">\(e\)</span>. It would also not be linear,
if the coefficients are in a square root or in the denominator of a fraction,
or in a sine or in a logarithm. You get the idea.</p>
</div>
<div id="adding_transformed_predictor" class="section level3 hasAnchor" number="4.1.2">
<h3><span class="header-section-number">4.1.2</span> Adding a transformed predictor to the model<a href="multiple-linear-regression.html#adding_transformed_predictor" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The world is not flat, although some people on YouTube might tell you otherwise.
In our context, not all regression is linear.</p>
<p>Around 4.5. in the book <a href="https://civil.colorado.edu/~balajir/CVEN6833/bayes-resources/RM-StatRethink-Bayes.pdf">Statistical Rethinking</a>
there is are lineare regression using a quadratic term for weight.
It is a principle, called the “<strong>variable inclusion principle</strong>”, that we always include the lower order terms when fitting a model
with higher order terms. See <a href="https://vdoc.pub/documents/understanding-regression-analysis-a-conditional-distribution-approach-84oqjr8sqva0">Westfall</a>,
p. 213. If we do not include the lower order terms, the coefficient does not measure what
we want it to meausure (curvature in our case). For instance, if we want to model a quadratic relationship (parabola) between
weight and height, we also have to include the linear term for weight (<span class="math inline">\(x_i\)</span>).
Since we do not assume the relationship between weight and height to be linear but
quadratic (which is a polynomial of degree 2), we call this a
<a href="https://en.wikipedia.org/wiki/Polynomial_regression#:~:text=In%20statistics%2C%20polynomial%20regression%20is,nth%20degree%20polynomial%20in%20x.">polynomial regression</a>.</p>
<p>This time, lets look at the whole age range of data from the !Kung San people.</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="multiple-linear-regression.html#cb97-1" tabindex="-1"></a><span class="fu">library</span>(rethinking)</span>
<span id="cb97-2"><a href="multiple-linear-regression.html#cb97-2" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb97-3"><a href="multiple-linear-regression.html#cb97-3" tabindex="-1"></a><span class="fu">data</span>(Howell1)</span>
<span id="cb97-4"><a href="multiple-linear-regression.html#cb97-4" tabindex="-1"></a>d <span class="ot">&lt;-</span> Howell1</span>
<span id="cb97-5"><a href="multiple-linear-regression.html#cb97-5" tabindex="-1"></a>d <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> weight, <span class="at">y =</span> height)) <span class="sc">+</span></span>
<span id="cb97-6"><a href="multiple-linear-regression.html#cb97-6" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb97-7"><a href="multiple-linear-regression.html#cb97-7" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span></span>
<span id="cb97-8"><a href="multiple-linear-regression.html#cb97-8" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;loess&quot;</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;
## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-55-1.png" width="672" /></p>
<p>It would not be a good idea to fit a linear trend through this data,
because we would not caupture the relationship adequately.
The red line is a <a href="https://en.wikipedia.org/wiki/Local_regression">loess smothing</a> line
which is often used to capture non-linear relationships.
The blue line is the usual line from classic linear regression (from the previous chapter).
Which one describes the data more accurately?
In this case it is obvious, a non-linear relationship is present and it might be a good idea
to model it. Modeling the relationshiop with a linear trend, leads to bad residuals with structure.
We will demonstrate this in the freuqentist setting.
Unfortunately, in more complex settings, with more predictors, it is not always so easy to see.</p>
<p>This time, we use the mean for the prior from the book (<span class="math inline">\(178 cm\)</span>).
The model equations are (see <a href="multiple-linear-regression.html#exercise2_multiple_regression">exercise 2</a>):</p>
<p><span class="math display">\[\begin{eqnarray*}
h_i &amp;\sim&amp; \text{Normal}(\mu_i, \sigma) \\
\mu_i &amp;=&amp; \alpha + \beta_1 x_i + \beta_2 x_i^2 \\
\alpha &amp;\sim&amp; \text{Normal}(178, 20) \\
\beta_1 &amp;\sim&amp; \text{Log-Normal}(0, 1) \\
\beta_2 &amp;\sim&amp; \text{Normal}(0, 1) \\
\sigma &amp;\sim&amp; \text{Uniform}(0, 50)
\end{eqnarray*}\]</span></p>
<p>The prior for <span class="math inline">\(\beta_1\)</span> is log-normal, because we can reasonably assume
the the overall linear trend is positive. The prior for <span class="math inline">\(\beta_2\)</span> is normal, because
we are not so sure. If we thought back to our school days to the topic of
“curve discussion” or parabolas, we could probably also assume that <span class="math inline">\(\beta_2\)</span> is negative.
But, data will show.</p>
<p>How can we interpret the model equations?
The model assumes that the <strong>expected</strong> height <span class="math inline">\(\mu_i\)</span> of a person <span class="math inline">\(i\)</span>
depends non-linearly on the weight <span class="math inline">\(x_i\)</span> of the person.
We are in the business of mean-modeling.
The prior for <span class="math inline">\(\sigma\)</span> is uniform as before.
The prior for <span class="math inline">\(\alpha\)</span> is normal with mean <span class="math inline">\(178\)</span> and standard deviation <span class="math inline">\(20\)</span>
because this is what we can expect from body heights in our experience.</p>
<p>Let’s <strong>fit the model</strong>:</p>
<p>We standardize the weight again and add the squared weights to the data set.
Standardizing the the predictors is a good idea, especially in polynomial regression
since squares and cubes of large numbers can get huge and cause numerical problems.</p>
<p>Let’s fit the model with the quadratic term for weight:</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="multiple-linear-regression.html#cb99-1" tabindex="-1"></a><span class="co"># Standardize weight</span></span>
<span id="cb99-2"><a href="multiple-linear-regression.html#cb99-2" tabindex="-1"></a>d<span class="sc">$</span>weight_s <span class="ot">&lt;-</span> (d<span class="sc">$</span>weight <span class="sc">-</span> <span class="fu">mean</span>(d<span class="sc">$</span>weight)) <span class="sc">/</span> <span class="fu">sd</span>(d<span class="sc">$</span>weight)</span>
<span id="cb99-3"><a href="multiple-linear-regression.html#cb99-3" tabindex="-1"></a><span class="co"># Square of standardized weight</span></span>
<span id="cb99-4"><a href="multiple-linear-regression.html#cb99-4" tabindex="-1"></a>d<span class="sc">$</span>weight_s2 <span class="ot">&lt;-</span> d<span class="sc">$</span>weight_s<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb99-5"><a href="multiple-linear-regression.html#cb99-5" tabindex="-1"></a>m4<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">quap</span>(</span>
<span id="cb99-6"><a href="multiple-linear-regression.html#cb99-6" tabindex="-1"></a>  <span class="fu">alist</span>(</span>
<span id="cb99-7"><a href="multiple-linear-regression.html#cb99-7" tabindex="-1"></a>    height <span class="sc">~</span> <span class="fu">dnorm</span>(mu, sigma),</span>
<span id="cb99-8"><a href="multiple-linear-regression.html#cb99-8" tabindex="-1"></a>    mu <span class="ot">&lt;-</span> a <span class="sc">+</span> b1<span class="sc">*</span>weight_s <span class="sc">+</span> b2<span class="sc">*</span>weight_s<span class="sc">^</span><span class="dv">2</span>,</span>
<span id="cb99-9"><a href="multiple-linear-regression.html#cb99-9" tabindex="-1"></a>    a <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">178</span>, <span class="dv">20</span>),</span>
<span id="cb99-10"><a href="multiple-linear-regression.html#cb99-10" tabindex="-1"></a>    b1 <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">0</span>, <span class="dv">10</span>),</span>
<span id="cb99-11"><a href="multiple-linear-regression.html#cb99-11" tabindex="-1"></a>    b2 <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">0</span>, <span class="dv">10</span>),</span>
<span id="cb99-12"><a href="multiple-linear-regression.html#cb99-12" tabindex="-1"></a>    sigma <span class="sc">~</span> <span class="fu">dunif</span>(<span class="dv">0</span>, <span class="dv">50</span>)</span>
<span id="cb99-13"><a href="multiple-linear-regression.html#cb99-13" tabindex="-1"></a>  ), <span class="at">data =</span> d)</span>
<span id="cb99-14"><a href="multiple-linear-regression.html#cb99-14" tabindex="-1"></a><span class="fu">precis</span>(m4<span class="fl">.1</span>)</span></code></pre></div>
<pre><code>##             mean        sd       5.5%      94.5%
## a     146.672739 0.3736465 146.075580 147.269898
## b1     21.397637 0.2898827  20.934348  21.860925
## b2     -8.419933 0.2813308  -8.869554  -7.970312
## sigma   5.750550 0.1743749   5.471865   6.029235</code></pre>
<p><span class="math inline">\(\beta_2\)</span> is indeed negative.
We get our <strong><a href="https://en.wikipedia.org/wiki/Joint_probability_distribution">join distribution</a></strong>
of the <strong>four model parameters</strong>.
Let’s look at the fit using the mean estimates of the posterior distribution:</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="multiple-linear-regression.html#cb101-1" tabindex="-1"></a><span class="co"># Summarize the model parameters</span></span>
<span id="cb101-2"><a href="multiple-linear-regression.html#cb101-2" tabindex="-1"></a>model_summary <span class="ot">&lt;-</span> <span class="fu">precis</span>(m4<span class="fl">.1</span>)</span>
<span id="cb101-3"><a href="multiple-linear-regression.html#cb101-3" tabindex="-1"></a>params <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(model_summary)</span>
<span id="cb101-4"><a href="multiple-linear-regression.html#cb101-4" tabindex="-1"></a></span>
<span id="cb101-5"><a href="multiple-linear-regression.html#cb101-5" tabindex="-1"></a><span class="co"># Extract parameter values</span></span>
<span id="cb101-6"><a href="multiple-linear-regression.html#cb101-6" tabindex="-1"></a>a <span class="ot">&lt;-</span> params[<span class="st">&quot;a&quot;</span>, <span class="st">&quot;mean&quot;</span>]       <span class="co"># Intercept</span></span>
<span id="cb101-7"><a href="multiple-linear-regression.html#cb101-7" tabindex="-1"></a>b1 <span class="ot">&lt;-</span> params[<span class="st">&quot;b1&quot;</span>, <span class="st">&quot;mean&quot;</span>]     <span class="co"># Coefficient for standardized weight</span></span>
<span id="cb101-8"><a href="multiple-linear-regression.html#cb101-8" tabindex="-1"></a>b2 <span class="ot">&lt;-</span> params[<span class="st">&quot;b2&quot;</span>, <span class="st">&quot;mean&quot;</span>]     <span class="co"># Coefficient for squared standardized weight</span></span>
<span id="cb101-9"><a href="multiple-linear-regression.html#cb101-9" tabindex="-1"></a></span>
<span id="cb101-10"><a href="multiple-linear-regression.html#cb101-10" tabindex="-1"></a><span class="co"># Generate a sequence of standardized weights for the fitted curve</span></span>
<span id="cb101-11"><a href="multiple-linear-regression.html#cb101-11" tabindex="-1"></a>weight_fine <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(d<span class="sc">$</span>weight_s), <span class="fu">max</span>(d<span class="sc">$</span>weight_s), <span class="at">length.out =</span> <span class="dv">200</span>)</span>
<span id="cb101-12"><a href="multiple-linear-regression.html#cb101-12" tabindex="-1"></a></span>
<span id="cb101-13"><a href="multiple-linear-regression.html#cb101-13" tabindex="-1"></a><span class="co"># Calculate the fitted values using the quadratic equation</span></span>
<span id="cb101-14"><a href="multiple-linear-regression.html#cb101-14" tabindex="-1"></a>height_fitted <span class="ot">&lt;-</span> a <span class="sc">+</span> b1 <span class="sc">*</span> weight_fine <span class="sc">+</span> b2 <span class="sc">*</span> weight_fine<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb101-15"><a href="multiple-linear-regression.html#cb101-15" tabindex="-1"></a></span>
<span id="cb101-16"><a href="multiple-linear-regression.html#cb101-16" tabindex="-1"></a><span class="co"># Plot the scatterplot</span></span>
<span id="cb101-17"><a href="multiple-linear-regression.html#cb101-17" tabindex="-1"></a><span class="fu">plot</span>(d<span class="sc">$</span>weight_s, d<span class="sc">$</span>height, <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>,</span>
<span id="cb101-18"><a href="multiple-linear-regression.html#cb101-18" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Standardized Weight&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Height (cm)&quot;</span>,</span>
<span id="cb101-19"><a href="multiple-linear-regression.html#cb101-19" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Scatterplot with Fitted Curve (Standardized Weight)&quot;</span>)</span>
<span id="cb101-20"><a href="multiple-linear-regression.html#cb101-20" tabindex="-1"></a></span>
<span id="cb101-21"><a href="multiple-linear-regression.html#cb101-21" tabindex="-1"></a><span class="co"># Add the fitted curve</span></span>
<span id="cb101-22"><a href="multiple-linear-regression.html#cb101-22" tabindex="-1"></a><span class="fu">lines</span>(weight_fine, height_fitted, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb101-23"><a href="multiple-linear-regression.html#cb101-23" tabindex="-1"></a></span>
<span id="cb101-24"><a href="multiple-linear-regression.html#cb101-24" tabindex="-1"></a><span class="co"># Add a legend</span></span>
<span id="cb101-25"><a href="multiple-linear-regression.html#cb101-25" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;Observed data&quot;</span>, <span class="st">&quot;Fitted curve&quot;</span>),</span>
<span id="cb101-26"><a href="multiple-linear-regression.html#cb101-26" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;red&quot;</span>), <span class="at">pch =</span> <span class="fu">c</span>(<span class="dv">16</span>, <span class="cn">NA</span>), <span class="at">lty =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="dv">1</span>), <span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-57-1.png" width="672" /></p>
<p>This fits much better than the linear model. In the book,
there is also a polynomial regression with a cubic term for weight.
Maybe this fits even better (see <a href="multiple-linear-regression.html#exercise1_multiple_regression">exercise 1</a>).</p>
<p>……….</p>
</div>
<div id="adding-another-predictor-to-the-model" class="section level3 hasAnchor" number="4.1.3">
<h3><span class="header-section-number">4.1.3</span> Adding another predictor to the model<a href="multiple-linear-regression.html#adding-another-predictor-to-the-model" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>….</p>
</div>
</div>
<div id="linear-regression-with-two-predictors-in-the-frequentist-framework" class="section level2 hasAnchor" number="4.2">
<h2><span class="header-section-number">4.2</span> Linear Regression with Two Predictors in the Frequentist Framework<a href="multiple-linear-regression.html#linear-regression-with-two-predictors-in-the-frequentist-framework" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="adding-a-transformed-predictor-to-the-model" class="section level3 hasAnchor" number="4.2.1">
<h3><span class="header-section-number">4.2.1</span> Adding a transformed predictor to the model<a href="multiple-linear-regression.html#adding-a-transformed-predictor-to-the-model" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>No, let’s fit the same model as above in the frequentist framework.</p>
<p>The model is:</p>
<p><span class="math display">\[height_i = \alpha + \beta_1 weight_i + \beta_2 weight_i^2 + \varepsilon_i\]</span>
whereas
<span class="math display">\[\varepsilon_i \sim N(0, \sigma)\]</span></p>
<p>We are looking for fixed, but unknown, parameters <span class="math inline">\(\alpha\)</span>, <span class="math inline">\(\beta_1\)</span>, <span class="math inline">\(\beta_2\)</span> and <span class="math inline">\(\sigma\)</span>.
This is fit again using the <code>lm</code> function in R which uses least squares to estimate the parameters.
At this point I could torture you with <a href="https://en.wikipedia.org/wiki/Matrix_(mathematics)">matrix algebra</a>
and show you the <a href="https://en.wikipedia.org/wiki/Linear_least_squares">normal equations</a> for linear regression,
but I will spare you for now.
Note that the least squares algorithm for fitting the curve works for all
kinds of functions. We could also fit an exponential curve using the same
technique.</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="multiple-linear-regression.html#cb102-1" tabindex="-1"></a><span class="co"># scale weight</span></span>
<span id="cb102-2"><a href="multiple-linear-regression.html#cb102-2" tabindex="-1"></a>d<span class="sc">$</span>weight_s <span class="ot">&lt;-</span> <span class="fu">scale</span>(d<span class="sc">$</span>weight)</span>
<span id="cb102-3"><a href="multiple-linear-regression.html#cb102-3" tabindex="-1"></a><span class="co"># Fit the model</span></span>
<span id="cb102-4"><a href="multiple-linear-regression.html#cb102-4" tabindex="-1"></a>m4<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(height <span class="sc">~</span> weight_s <span class="sc">+</span> <span class="fu">I</span>(weight_s<span class="sc">^</span><span class="dv">2</span>), <span class="at">data =</span> d)</span>
<span id="cb102-5"><a href="multiple-linear-regression.html#cb102-5" tabindex="-1"></a><span class="fu">summary</span>(m4<span class="fl">.2</span>)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = height ~ weight_s + I(weight_s^2), data = d)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -19.9689  -3.9794   0.2364   3.9262  19.5182 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   146.6604     0.3748  391.30   &lt;2e-16 ***
## weight_s       21.4149     0.2908   73.64   &lt;2e-16 ***
## I(weight_s^2)  -8.4123     0.2822  -29.80   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 5.766 on 541 degrees of freedom
## Multiple R-squared:  0.9565, Adjusted R-squared:  0.9564 
## F-statistic:  5952 on 2 and 541 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>See <code>?I</code> in R. This command is used so that R knows that it should
treat the “^2” as “square” and not as formula syntax.
We could also create a new variable as before. Whatever you prefer.</p>
<div id="interpretation-of-output-and-coefficients" class="section level4 hasAnchor" number="4.2.1.1">
<h4><span class="header-section-number">4.2.1.1</span> Interpretation of output and coefficients<a href="multiple-linear-regression.html#interpretation-of-output-and-coefficients" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ul>
<li>The intercept <span class="math inline">\(\alpha\)</span> is the <strong>model-predicted height</strong> of a person of <strong>average weight</strong>.
Note that this is not the average height of the people in the data set, since the
mean model is also a model, but different from ours.</li>
<li>The residuals have range from <span class="math inline">\(-19.97\)</span> to <span class="math inline">\(19.51\)</span>. So, the model maximally
overestimates the heights by <span class="math inline">\(19.97\)</span> cm and underestimates by <span class="math inline">\(19.51\)</span> cm.
These numbers are plausible when you look at the scatterplot with the fitted
curve.</li>
<li>The coefficients <span class="math inline">\(\beta_1\)</span> and <span class="math inline">\(\beta_2\)</span> agree with the Bayes estimates.
Specifically, <span class="math inline">\(\beta_2\)</span> is non-zero indicating curvature.</li>
<li>If you like <span class="math inline">\(p\)</span>-values: All the hypotheses that the coefficients are zero
are rejected. The <span class="math inline">\(p\)</span>-values are very small. The data can not be explained
by chance alone. On the other hand, for at least <span class="math inline">\(\beta_1\)</span> and
and the global test this is not a surprise when you look at the scatterplot.</li>
<li>The <span class="math inline">\(R^2\)</span> is a whopping <span class="math inline">\(0.96\)</span> which could be a sign of overfitting, but
in this case we conclude that the true relationship is caputured rather well.
<a href="https://en.wikipedia.org/wiki/Overfitting">Overfitting</a> would occur if
our curve would wiggle around the data points,
so we would fit the data too much to the noise in the data than
the underying trend.</li>
</ul>
</div>
<div id="checking-model-assumptions" class="section level4 hasAnchor" number="4.2.1.2">
<h4><span class="header-section-number">4.2.1.2</span> Checking model assumptions<a href="multiple-linear-regression.html#checking-model-assumptions" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="multiple-linear-regression.html#cb104-1" tabindex="-1"></a><span class="fu">check_model</span>(m4<span class="fl">.2</span>)</span></code></pre></div>
<pre><code>## Some of the variables were in matrix-format - probably you used
##   `scale()` on your data?
##   If so, and you get an error, please try `datawizard::standardize()` to
##   standardize your data.
## Some of the variables were in matrix-format - probably you used
##   `scale()` on your data?
##   If so, and you get an error, please try `datawizard::standardize()` to
##   standardize your data.</code></pre>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-59-1.png" width="672" /></p>
<p>If we want to be perfectionists, we could remark that (upper right plot)
in the lower fitted values the residuals are more negative,
meaning that the model overestimates the heights in this region.
In the middle region the model underestimates a bit and we can see
a positive tendency in the residuals. Apart from that,
the diagnostic plots look excellent.</p>
</div>
</div>
<div id="adding-another-predictor-to-the-model-1" class="section level3 hasAnchor" number="4.2.2">
<h3><span class="header-section-number">4.2.2</span> Adding another predictor to the model<a href="multiple-linear-regression.html#adding-another-predictor-to-the-model-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Now, we add another predictor to the model. We use <span class="math inline">\(X_1\)</span> and <span class="math inline">\(X_2\)</span>
<strong>simultaneously</strong> to predict <span class="math inline">\(Y\)</span>. We are now in the lucky situation that
we can still visualize the situation in 3D. The regression line from simple
linear regression
becomes a <a href="https://stackoverflow.com/questions/47344850/scatterplot3d-regression-plane-with-residuals">plane</a>.
The vertical distances between the data points and the plane are the residuals.
See <a href="https://rpubs.com/pjozefek/576206">here</a> or
<a href="https://www.sthda.com/english/wiki/scatterplot3d-3d-graphics-r-software-and-data-visualization">here</a>
at the end for examples.
Minimizing the sum of the squared errors gives again
the estimates for the coefficients.</p>
<p>For demonstration purposes, we can create data ourselves with known
coefficients.
This is the true model, which we usually do not know:</p>
<p><span class="math display">\[ Y_i = \beta_0 + \beta_1 X_{1i} + \beta_2 X_{2i} + \varepsilon_i\]</span>
<span class="math display">\[ \varepsilon_i \sim N(0, \sigma^2)\]</span>
<span class="math display">\[ \mathbb{E}(Y_i|X_1 = x_1; X_2 = x_2) = \beta_0 + \beta_1 x_1 + \beta_2 x_2\]</span>
<span class="math display">\[ i = 1 \ldots n\]</span></p>
<p>for example:</p>
<p><span class="math display">\[ Y_i = 10 + 0.5 \cdot X_{1i} + 1 \cdot X_{2i} + \varepsilon_i\]</span>
<span class="math display">\[ \varepsilon_i \sim N(0, 5)\]</span>
<span class="math display">\[ \mathbb{E}(Y_i|X_1 = x_1; X_2 = x_2) = 10 + 0.5 x_1 + 1 x_2\]</span>
<span class="math display">\[ i = 1 \ldots n\]</span></p>
<p>According to the model, the conditional expected value of <span class="math inline">\(Y_i\)</span> given <span class="math inline">\(X_1 = x_1\)</span> and <span class="math inline">\(X_2 = x_2\)</span>
is a linear function of <span class="math inline">\(x_1\)</span> and <span class="math inline">\(x_2\)</span>. Note, that small letters are realized values
of random variables. Also note, that in the expectation the error term goes away, since
<span class="math inline">\(\mathbb{E}(\varepsilon_i) = 0\)</span>.</p>
<ul>
<li>If <span class="math inline">\(X_1\)</span> increases by one unit, <span class="math inline">\(Y\)</span> increases by <span class="math inline">\(0.5\)</span> units on average (in expectation).</li>
<li>If <span class="math inline">\(X_2\)</span> increases by one unit, <span class="math inline">\(Y\)</span> increases by <span class="math inline">\(1\)</span> unit on average (in expectation).</li>
<li>If <span class="math inline">\(X_1\)</span> and <span class="math inline">\(X_2\)</span> are zero, <span class="math inline">\(Y\)</span> is <span class="math inline">\(10\)</span> on average (in expectation).</li>
</ul>
<p>Why in expectation? Because there is still the error term which makes the whole thing random!
We can see that an increase in <span class="math inline">\(X_1\)</span> does not influence the relationship between <span class="math inline">\(X_2\)</span> and <span class="math inline">\(Y\)</span>.
Hence, there is <strong>no interaction</strong> between <span class="math inline">\(X_1\)</span> and <span class="math inline">\(X_2\)</span> with respect to <span class="math inline">\(Y\)</span>.</p>
<p>Now lets’s draw 100 points from this model, fit the model and add the plane:</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="multiple-linear-regression.html#cb106-1" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb106-2"><a href="multiple-linear-regression.html#cb106-2" tabindex="-1"></a></span>
<span id="cb106-3"><a href="multiple-linear-regression.html#cb106-3" tabindex="-1"></a><span class="co">#set.seed(123)</span></span>
<span id="cb106-4"><a href="multiple-linear-regression.html#cb106-4" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb106-5"><a href="multiple-linear-regression.html#cb106-5" tabindex="-1"></a>X1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">5</span>)</span>
<span id="cb106-6"><a href="multiple-linear-regression.html#cb106-6" tabindex="-1"></a>X2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">5</span>)</span>
<span id="cb106-7"><a href="multiple-linear-regression.html#cb106-7" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="sc">+</span> <span class="fl">0.5</span> <span class="sc">*</span> X1 <span class="sc">+</span> <span class="dv">1</span> <span class="sc">*</span> X2 <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">2</span>)</span>
<span id="cb106-8"><a href="multiple-linear-regression.html#cb106-8" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">X1 =</span> X1, <span class="at">X2 =</span> X2, <span class="at">Y =</span> Y)</span>
<span id="cb106-9"><a href="multiple-linear-regression.html#cb106-9" tabindex="-1"></a></span>
<span id="cb106-10"><a href="multiple-linear-regression.html#cb106-10" tabindex="-1"></a><span class="co"># Fit the model</span></span>
<span id="cb106-11"><a href="multiple-linear-regression.html#cb106-11" tabindex="-1"></a>m4<span class="fl">.3</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y <span class="sc">~</span> X1 <span class="sc">+</span> X2, <span class="at">data =</span> d)</span>
<span id="cb106-12"><a href="multiple-linear-regression.html#cb106-12" tabindex="-1"></a><span class="fu">summary</span>(m4<span class="fl">.3</span>)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = Y ~ X1 + X2, data = d)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -4.8674 -1.3924  0.0682  1.7914  4.9145 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 10.19906    0.21844   46.69   &lt;2e-16 ***
## X1           0.56391    0.04348   12.97   &lt;2e-16 ***
## X2           1.01708    0.04507   22.57   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 2.169 on 97 degrees of freedom
## Multiple R-squared:  0.8801, Adjusted R-squared:  0.8776 
## F-statistic:   356 on 2 and 97 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="multiple-linear-regression.html#cb108-1" tabindex="-1"></a><span class="co"># Create a grid for the plane</span></span>
<span id="cb108-2"><a href="multiple-linear-regression.html#cb108-2" tabindex="-1"></a>X1_grid <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(d<span class="sc">$</span>X1), <span class="fu">max</span>(d<span class="sc">$</span>X1), <span class="at">length.out =</span> <span class="dv">20</span>)</span>
<span id="cb108-3"><a href="multiple-linear-regression.html#cb108-3" tabindex="-1"></a>X2_grid <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(d<span class="sc">$</span>X2), <span class="fu">max</span>(d<span class="sc">$</span>X2), <span class="at">length.out =</span> <span class="dv">20</span>)</span>
<span id="cb108-4"><a href="multiple-linear-regression.html#cb108-4" tabindex="-1"></a>grid <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">X1 =</span> X1_grid, <span class="at">X2 =</span> X2_grid)</span>
<span id="cb108-5"><a href="multiple-linear-regression.html#cb108-5" tabindex="-1"></a></span>
<span id="cb108-6"><a href="multiple-linear-regression.html#cb108-6" tabindex="-1"></a><span class="co"># Predict the values for the grid</span></span>
<span id="cb108-7"><a href="multiple-linear-regression.html#cb108-7" tabindex="-1"></a>grid<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">predict</span>(m4<span class="fl">.3</span>, <span class="at">newdata =</span> grid)</span>
<span id="cb108-8"><a href="multiple-linear-regression.html#cb108-8" tabindex="-1"></a></span>
<span id="cb108-9"><a href="multiple-linear-regression.html#cb108-9" tabindex="-1"></a><span class="co"># Convert the grid into a matrix for the plane</span></span>
<span id="cb108-10"><a href="multiple-linear-regression.html#cb108-10" tabindex="-1"></a>plane_matrix <span class="ot">&lt;-</span> <span class="fu">matrix</span>(grid<span class="sc">$</span>Y, <span class="at">nrow =</span> <span class="fu">length</span>(X1_grid), <span class="at">ncol =</span> <span class="fu">length</span>(X2_grid))</span>
<span id="cb108-11"><a href="multiple-linear-regression.html#cb108-11" tabindex="-1"></a></span>
<span id="cb108-12"><a href="multiple-linear-regression.html#cb108-12" tabindex="-1"></a><span class="co"># Create the interactive 3D plot</span></span>
<span id="cb108-13"><a href="multiple-linear-regression.html#cb108-13" tabindex="-1"></a><span class="fu">plot_ly</span>() <span class="sc">%&gt;%</span></span>
<span id="cb108-14"><a href="multiple-linear-regression.html#cb108-14" tabindex="-1"></a>  <span class="fu">add_markers</span>(</span>
<span id="cb108-15"><a href="multiple-linear-regression.html#cb108-15" tabindex="-1"></a>    <span class="at">x =</span> d<span class="sc">$</span>X2, <span class="at">y =</span> d<span class="sc">$</span>X1, <span class="at">z =</span> d<span class="sc">$</span>Y,</span>
<span id="cb108-16"><a href="multiple-linear-regression.html#cb108-16" tabindex="-1"></a>    <span class="at">marker =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">size =</span> <span class="dv">5</span>),</span>
<span id="cb108-17"><a href="multiple-linear-regression.html#cb108-17" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">&quot;Data Points&quot;</span></span>
<span id="cb108-18"><a href="multiple-linear-regression.html#cb108-18" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb108-19"><a href="multiple-linear-regression.html#cb108-19" tabindex="-1"></a>  <span class="fu">add_surface</span>(</span>
<span id="cb108-20"><a href="multiple-linear-regression.html#cb108-20" tabindex="-1"></a>    <span class="at">x =</span> X1_grid, <span class="at">y =</span> X2_grid, <span class="at">z =</span> plane_matrix,</span>
<span id="cb108-21"><a href="multiple-linear-regression.html#cb108-21" tabindex="-1"></a>    <span class="at">colorscale =</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;pink&quot;</span>)),</span>
<span id="cb108-22"><a href="multiple-linear-regression.html#cb108-22" tabindex="-1"></a>    <span class="at">showscale =</span> <span class="cn">FALSE</span>,</span>
<span id="cb108-23"><a href="multiple-linear-regression.html#cb108-23" tabindex="-1"></a>    <span class="at">opacity =</span> <span class="fl">0.7</span>,</span>
<span id="cb108-24"><a href="multiple-linear-regression.html#cb108-24" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">&quot;Fitted Plane&quot;</span></span>
<span id="cb108-25"><a href="multiple-linear-regression.html#cb108-25" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb108-26"><a href="multiple-linear-regression.html#cb108-26" tabindex="-1"></a>  plotly<span class="sc">::</span><span class="fu">layout</span>(</span>
<span id="cb108-27"><a href="multiple-linear-regression.html#cb108-27" tabindex="-1"></a>    <span class="at">scene =</span> <span class="fu">list</span>(</span>
<span id="cb108-28"><a href="multiple-linear-regression.html#cb108-28" tabindex="-1"></a>      <span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">&quot;X1&quot;</span>),</span>
<span id="cb108-29"><a href="multiple-linear-regression.html#cb108-29" tabindex="-1"></a>      <span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">&quot;X2&quot;</span>),</span>
<span id="cb108-30"><a href="multiple-linear-regression.html#cb108-30" tabindex="-1"></a>      <span class="at">zaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">&quot;Y&quot;</span>)</span>
<span id="cb108-31"><a href="multiple-linear-regression.html#cb108-31" tabindex="-1"></a>    ),</span>
<span id="cb108-32"><a href="multiple-linear-regression.html#cb108-32" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Interactive 3D Scatterplot with Fitted Plane&quot;</span></span>
<span id="cb108-33"><a href="multiple-linear-regression.html#cb108-33" tabindex="-1"></a>  )</span></code></pre></div>
<div class="plotly html-widget html-fill-item" id="htmlwidget-db3fc13d0a6fac40b8c2" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-db3fc13d0a6fac40b8c2">{"x":{"visdat":{"e58d19593227":["function () ","plotlyVisDat"]},"cur_data":"e58d19593227","attrs":{"e58d19593227":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[4.9969032817785353,0.90943797760716993,6.9314598254435991,3.6226375746787536,2.9691683715709094,4.8665263157379259,-7.135202192320623,1.1437045929830405,-6.2769352114134449,-0.61879467842508096,4.2659458188962072,-0.55694953166174255,-3.1087396786061587,-6.6396705197799282,3.9414202918608847,2.9662866968501636,-2.9214051769993215,-12.635678502915102,-2.303389914281317,8.2368387176791842,9.2647811509865026,0.83753388674431839,-2.1340748409457828,-0.98045186340036994,-3.9063878569938133,-6.7575812434122717,0.59132884266539776,-0.61547849053272641,3.4784928454256607,5.5369892862135934,6.2159157894799586,-6.5066613949434142,-4.4129102627515424,-2.2058386401299348,1.9646799483433526,-3.200138602070377,-1.8511764387933052,-11.083620958081088,-3.3609970090922419,-1.7116350595614593,-1.0981445258618525,4.0138334838695595,-6.7425637421776008,2.9646714834080918,-0.51558650580723631,3.3340448754188095,5.4050090589984645,5.3751177838838036,-8.0906501768692394,-3.8161645040485221,6.1742241796133897,-1.5829087722307991,-1.8558335279644176,2.6267062752323977,8.1578116811456596,-9.9472154934841726,-0.91188190941214664,4.4800047489975627,0.35306846767978717,-0.14914947191021338,0.55058698485430635,-3.5880431359148508,-7.7373148274431411,-0.49889641840334675,1.941012995161024,2.4266837935935519,11.274210688882228,0.25267076311550396,-2.2070170056583862,4.0687169198379944,-11.220937387254303,-6.1805237301135545,1.8310194420451775,2.2109395846898048,2.6501810783174,-4.2858754733754854,1.7606728885627032,1.8834016804552325,2.0160401340326581,-2.0601395395281688,-4.0213709167437788,3.7210996822845104,-8.1209055668828594,3.2807341620285735,0.050011099912689816,-1.6846159952555002,-0.98406025041276068,-1.6850309948051274,-3.4952534296405298,2.1721124032539816,-5.522914278704139,-7.3051509749411689,2.5466478209843353,-4.8842298423022932,-4.4198987814703958,6.8190564761585097,0.12851188129745467,-7.5005645143501116,-8.8303331901929045,-0.027032243361120516],"y":[-4.6279497208506575,0.75327256908963047,-1.7324897722498265,3.8272877661328968,3.4589593398809892,1.0547728991143877,-4.7629257836596732,3.4681484841523464,-2.9265439422264312,5.5233222392978156,-0.75572537976537846,0.078352096434636545,-1.2739363708393965,-0.80704459396852579,-1.2982403227091597,0.9208471381558625,5.9183175726958934,3.9436387581919323,-7.9803313815658417,-6.9138855322883943,15.508417494779883,-2.6811445476616438,0.85980735216432636,-2.8814455465364315,2.9980615677316278,6.7032281172703527,0.46552279503688426,1.0955767953169657,8.7137509420341548,-6.1966700124642351,-11.27540444842645,-3.3344243247400511,0.69522781341523443,-2.5823549397310979,8.9039245552411632,4.0272082760484693,4.0718766963436108,-1.9845739246594352,2.5576105574953423,-0.22856847391870841,1.1652203895037709,-4.3836248538766922,8.82564958348296,5.4441770863484997,6.5091183555182841,-8.0416918532966513,-5.0998593513480515,-0.14098367552424471,-6.3404067291794686,-3.6268496659826139,-0.96489589248915497,0.73830893808246312,3.1847787516419404,1.6843453355752622,-9.0778618730005753,-4.50588837279982,0.48919598617398247,-5.545854375189764,-2.4572513648651668,2.1238554648413559,7.8687107391603384,-5.0455931152170175,0.16545562325169139,-5.3054504479922073,-0.053065870227709595,1.3693751462928405,2.7771839381120729,4.2923243141036043,-0.23963054705381404,4.7451010917130469,-1.1099414914175985,5.1964805408639396,12.686430175405917,2.0908585152473531,-0.32926486733171978,-1.2379122340983493,-4.4602097162659069,4.5748148124144707,3.2358216254081102,-6.6941739026903457,10.012544022752142,6.7353166285898602,1.5329719697030444,-4.2677236304491331,1.8828598170031252,-0.78896755054865308,-7.0984242539751898,-6.9943196155706637,-3.6560118987859025,-0.37929071060736608,-1.0157613983551663,-6.7490268732925802,12.06249319866755,-3.4256655988128841,-5.7060447936414089,1.6208500579740273,-1.0447145346883531,-5.9481717740498228,3.6518580101851765,-2.7944842707135238],"z":[9.8501518827623737,12.212645588258463,15.716063589866415,16.348537100595834,14.668414872607762,17.824188881473837,-4.130955054895777,12.838375035551078,0.76165081253557676,13.152684795347781,12.223884657162733,11.466003691629165,8.2939416150766583,-0.47235805601363223,13.195960300820593,13.943140048100133,12.238893108894175,0.099864990713857682,8.2706743712043078,16.71441045087354,27.579693677552655,10.18429679297811,4.8222773611795517,8.6015517885470167,9.8587917497864996,6.1198280545438131,6.19558305494796,7.5047192009761963,20.959822143285336,14.134174241360116,10.400874544759946,1.9169383978899766,5.4644595810017869,8.5727731163010183,14.275517793610689,7.4753396485243133,8.6714066924082918,-4.1344516374554745,8.0794351034963068,10.490397600124791,8.9020611923243429,10.439295321809244,8.7605115745068129,18.714228450907928,12.494830206693424,7.4348321679764258,14.821026961977482,12.776648172077367,2.779180560096143,4.8342232023631571,17.899559626378124,6.4321263410198659,12.014823099065568,13.491937047949838,8.9434011007408412,-3.5147252160944928,9.3379256551419765,12.333802435767069,12.368793762733219,10.988581184624614,15.887315898813533,5.5248493583930181,4.7658528371636244,6.1493671480189915,13.300635339680277,13.439250248820578,21.447519749223584,11.42868525853731,9.5800736619378579,14.128575156000156,-0.9622530961822815,6.9798053330298213,18.313622912183735,12.722391038896456,11.742195487728658,4.2502543480897437,12.145573872755165,17.305593888998089,17.337428410092041,5.0575001722073871,15.982436101152985,16.392909185211877,-1.7161830744010151,8.330502979144196,10.005175293660233,3.3955478946485593,5.5984768577242345,5.5493955021576662,7.4215173088429927,15.073945287661893,6.0727302739245603,-3.9867177370122442,21.088452959556015,3.2602160983793627,3.9517427988390335,22.296704786336846,7.6881813078396739,-2.2396574499472051,4.4866087503976866,8.0271791719963339],"type":"scatter3d","mode":"markers","marker":{"color":"blue","size":5},"name":"Data Points","inherit":true},"e58d19593227.1":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"z":[[-9.0107443166754351,-7.7308321799699957,-6.4509200432645555,-5.1710079065591144,-3.8910957698536746,-2.6111836331482343,-1.3312714964427943,-0.051359359737353158,1.2285527769680862,2.5084649136735253,3.7883770503789664,5.0682891870844076,6.3482013237898469,7.6281134604952863,8.9080255972007283,10.187937733906168,11.467849870611607,12.747762007317046,14.027674144022486,15.307586280727929],[-8.2158190928163499,-6.9359069561109106,-5.6559948194054703,-4.3760826827000292,-3.0961705459945894,-1.8162584092891494,-0.53634627258370915,0.74356586412173198,2.0234780008271711,3.3033901375326105,4.5833022742380516,5.8632144109434927,7.1431265476489321,8.4230386843543705,9.7029508210598134,10.982862957765253,12.262775094470692,13.542687231176131,14.822599367881571,16.102511504587014],[-7.4208938689572648,-6.1409817322518254,-4.8610695955463852,-3.5811574588409436,-2.3012453221355043,-1.0213331854300642,0.25857895127537606,1.5384910879808171,2.8184032246862563,4.0983153613916956,5.3782274980971367,6.6581396348025779,7.9380517715080172,9.2179639082134557,10.497876044918899,11.777788181624338,13.057700318329777,14.337612455035217,15.617524591740656,16.897436728446099],[-6.6259686450981805,-5.3460565083927412,-4.0661443716873009,-2.7862322349818593,-1.50632009827642,-0.22640796157097989,1.0535041751344603,2.3334163118399016,3.6133284485453405,4.8932405852507799,6.173152721956221,7.4530648586616621,8.7329769953671015,10.012889132072541,11.292801268777984,12.572713405483423,13.852625542188862,15.132537678894302,16.412449815599739,17.692361952305184],[-5.8310434212390954,-4.551131284533656,-3.2712191478282153,-1.9913070111227742,-0.71139487441733495,0.56851726228810529,1.8484293989935454,3.1283415356989868,4.4082536724044257,5.688165809109865,6.9680779458153062,8.2479900825207473,9.5279022192261866,10.807814355931626,12.087726492637069,13.367638629342508,14.647550766047948,15.927462902753387,17.207375039458825,18.487287176164269],[-5.0361181973800102,-3.7562060606745713,-2.4762939239691302,-1.196381787263689,0.08353034944175021,1.3634424861471903,2.6433546228526308,3.9232667595580719,5.2031788962635108,6.4830910329689502,7.7630031696743913,9.0429153063798324,10.322827443085272,11.602739579790711,12.882651716496154,14.162563853201593,15.442475989907033,16.722388126612472,18.00230026331791,19.282212400023354],[-4.2411929735209259,-2.961280836815487,-1.6813687001100459,-0.40145656340460484,0.87845557330083446,2.1583677100062748,3.438279846711715,4.7181919834171557,5.9981041201225951,7.2780162568280344,8.5579283935334765,9.8378405302389176,11.117752666944357,12.397664803649795,13.677576940355237,14.957489077060677,16.237401213766116,17.517313350471557,18.797225487176995,20.077137623882439],[-3.4462677496618412,-2.1663556129564019,-0.88644347625096076,0.39346866045448031,1.6733807971599197,2.95329293386536,4.2332050705707998,5.5131172072762409,6.7930293439816802,8.0729414806871205,9.3528536173925616,10.632765754098003,11.912677890803442,13.19259002750888,14.472502164214323,15.752414300919762,17.032326437625201,18.312238574330642,19.59215071103608,20.872062847741525],[-2.6513425258027561,-1.3714303890973167,-0.091518252391875624,1.1883938843135655,2.4683060210190049,3.7482181577244451,5.0281302944298849,6.308042431135326,7.5879545678407654,8.8678667045462056,10.147778841251647,11.427690977957088,12.707603114662527,13.987515251367965,15.267427388073408,16.547339524778849,17.827251661484286,19.107163798189728,20.387075934895165,21.66698807160061],[-1.8564173019436709,-0.57650516523823159,0.70340697146720954,1.9833191081726507,3.26323124487809,4.5431433815835298,5.8230555182889701,7.1029676549944112,8.3828797916998514,9.6627919284052908,10.942704065110732,12.222616201816173,13.502528338521612,14.78244047522705,16.062352611932493,17.342264748637934,18.622176885343372,19.902089022048813,21.18200115875425,22.461913295459695],[-1.0614920780845858,0.21842005862085356,1.4983321953262947,2.7782443320317358,4.0581564687371747,5.338068605442615,6.6179807421480552,7.8978928788534963,9.1778050155589366,10.457717152264376,11.737629288969817,13.017541425675258,14.297453562380698,15.577365699086135,16.857277835791578,18.137189972497019,19.417102109202457,20.697014245907898,21.976926382613335,23.25683851931878],[-0.26656685422550058,1.0133452824799387,2.2932574191853798,3.573169555890821,4.8530816925962599,6.1329938293017001,7.4129059660071404,8.6928181027125824,9.9727302394180217,11.252642376123461,12.532554512828902,13.812466649534343,15.092378786239783,16.372290922945222,17.652203059650663,18.932115196356104,20.212027333061542,21.491939469766983,22.771851606472421,24.051763743177865],[0.52835836963358462,1.8082705063390239,3.088182643044465,4.3680947797499057,5.648006916455345,6.9279190531607853,8.2078311898662264,9.4877433265716675,10.767655463277107,12.047567599982546,13.327479736687987,14.607391873393428,15.887304010098868,17.167216146804307,18.447128283509748,19.727040420215189,21.006952556920627,22.286864693626068,23.566776830331506,24.84668896703695],[1.3232835934926697,2.603195730198109,3.8831078669035501,5.1630200036089908,6.4429321403144302,7.7228442770198704,9.0027564137253115,10.282668550430753,11.562580687136192,12.842492823841631,14.122404960547073,15.402317097252514,16.682229233957951,17.962141370663392,19.242053507368833,20.521965644074275,21.801877780779712,23.081789917485153,24.361702054190591,25.641614190896036],[2.1182088173517548,3.3981209540571942,4.6780330907626348,5.957945227468076,7.2378573641735153,8.5177695008789556,9.7976816375843967,11.077593774289838,12.357505910995277,13.637418047700717,14.917330184406158,16.197242321111599,17.477154457817036,18.757066594522477,20.036978731227919,21.31689086793336,22.596803004638797,23.876715141344238,25.156627278049676,26.436539414755121],[2.91313404121084,4.1930461779162798,5.47295831462172,6.7528704513271611,8.0327825880326014,9.3126947247380407,10.592606861443482,11.872518998148923,13.152431134854362,14.432343271559802,15.712255408265243,16.992167544970684,18.272079681676122,19.551991818381563,20.831903955087004,22.111816091792445,23.391728228497882,24.671640365203324,25.951552501908761,27.231464638614206],[3.7080592650699233,4.9879714017753631,6.2678835384808034,7.5477956751862445,8.8277078118916847,10.107619948597124,11.387532085302565,12.667444222008006,13.947356358713446,15.227268495418885,16.507180632124324,17.787092768829766,19.067004905535207,20.346917042240644,21.626829178946089,22.906741315651526,24.186653452356968,25.466565589062405,26.746477725767846,28.026389862473287],[4.5029844889290089,5.7828966256344483,7.0628087623398885,8.3427208990453305,9.6226330357507699,10.902545172456209,12.18245730916165,13.462369445867091,14.742281582572531,16.022193719277968,17.30210585598341,18.582017992688851,19.861930129394292,21.141842266099729,22.421754402805174,23.701666539510612,24.981578676216053,26.26149081292149,27.541402949626931,28.821315086332373],[5.2979097127880941,6.5778218494935334,7.8577339861989737,9.1376461229044157,10.417558259609855,11.697470396315294,12.977382533020736,14.257294669726177,15.537206806431616,16.817118943137054,18.097031079842495,19.376943216547936,20.656855353253377,21.936767489958815,23.216679626664259,24.496591763369697,25.776503900075138,27.056416036780575,28.336328173486017,29.616240310191458],[6.0928349366471792,7.3727470733526186,8.6526592100580597,9.9325713467635008,11.21248348346894,12.49239562017438,13.772307756879821,15.052219893585262,16.332132030290701,17.612044166996139,18.89195630370158,20.171868440407021,21.451780577112462,22.7316927138179,24.011604850523344,25.291516987228782,26.571429123934223,27.851341260639661,29.131253397345102,30.411165534050543]],"type":"surface","x":[-11.27540444842645,-9.8657296093103266,-8.4560547701942035,-7.0463799310780812,-5.6367050919619581,-4.227030252845835,-2.8173554137297128,-1.4076805746135896,0.0019942645025334826,1.4116691036186566,2.8213439427347797,4.2310187818509029,5.6406936209670242,7.0503684600831491,8.4600432991992705,9.8697181383153954,11.279392977431517,12.689067816547638,14.098742655663763,15.508417494779883],"y":[-12.635678502915102,-11.377263282294191,-10.118848061673278,-8.8604328410523649,-7.6020176204314538,-6.3436023998105417,-5.0851871791896297,-3.8267719585687168,-2.5683567379478056,-1.3099415173268945,-0.051526296705981522,1.2068889239149314,2.4653041445358426,3.7237193651567537,4.9821345857776684,6.2405498063985796,7.4989650270194907,8.7573802476404019,10.015795468261313,11.274210688882228],"colorscale":[[0,1],["red","pink"]],"showscale":false,"opacity":0.69999999999999996,"name":"Fitted Plane","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"scene":{"xaxis":{"title":"X1"},"yaxis":{"title":"X2"},"zaxis":{"title":"Y"}},"title":"Interactive 3D Scatterplot with Fitted Plane","hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[4.9969032817785353,0.90943797760716993,6.9314598254435991,3.6226375746787536,2.9691683715709094,4.8665263157379259,-7.135202192320623,1.1437045929830405,-6.2769352114134449,-0.61879467842508096,4.2659458188962072,-0.55694953166174255,-3.1087396786061587,-6.6396705197799282,3.9414202918608847,2.9662866968501636,-2.9214051769993215,-12.635678502915102,-2.303389914281317,8.2368387176791842,9.2647811509865026,0.83753388674431839,-2.1340748409457828,-0.98045186340036994,-3.9063878569938133,-6.7575812434122717,0.59132884266539776,-0.61547849053272641,3.4784928454256607,5.5369892862135934,6.2159157894799586,-6.5066613949434142,-4.4129102627515424,-2.2058386401299348,1.9646799483433526,-3.200138602070377,-1.8511764387933052,-11.083620958081088,-3.3609970090922419,-1.7116350595614593,-1.0981445258618525,4.0138334838695595,-6.7425637421776008,2.9646714834080918,-0.51558650580723631,3.3340448754188095,5.4050090589984645,5.3751177838838036,-8.0906501768692394,-3.8161645040485221,6.1742241796133897,-1.5829087722307991,-1.8558335279644176,2.6267062752323977,8.1578116811456596,-9.9472154934841726,-0.91188190941214664,4.4800047489975627,0.35306846767978717,-0.14914947191021338,0.55058698485430635,-3.5880431359148508,-7.7373148274431411,-0.49889641840334675,1.941012995161024,2.4266837935935519,11.274210688882228,0.25267076311550396,-2.2070170056583862,4.0687169198379944,-11.220937387254303,-6.1805237301135545,1.8310194420451775,2.2109395846898048,2.6501810783174,-4.2858754733754854,1.7606728885627032,1.8834016804552325,2.0160401340326581,-2.0601395395281688,-4.0213709167437788,3.7210996822845104,-8.1209055668828594,3.2807341620285735,0.050011099912689816,-1.6846159952555002,-0.98406025041276068,-1.6850309948051274,-3.4952534296405298,2.1721124032539816,-5.522914278704139,-7.3051509749411689,2.5466478209843353,-4.8842298423022932,-4.4198987814703958,6.8190564761585097,0.12851188129745467,-7.5005645143501116,-8.8303331901929045,-0.027032243361120516],"y":[-4.6279497208506575,0.75327256908963047,-1.7324897722498265,3.8272877661328968,3.4589593398809892,1.0547728991143877,-4.7629257836596732,3.4681484841523464,-2.9265439422264312,5.5233222392978156,-0.75572537976537846,0.078352096434636545,-1.2739363708393965,-0.80704459396852579,-1.2982403227091597,0.9208471381558625,5.9183175726958934,3.9436387581919323,-7.9803313815658417,-6.9138855322883943,15.508417494779883,-2.6811445476616438,0.85980735216432636,-2.8814455465364315,2.9980615677316278,6.7032281172703527,0.46552279503688426,1.0955767953169657,8.7137509420341548,-6.1966700124642351,-11.27540444842645,-3.3344243247400511,0.69522781341523443,-2.5823549397310979,8.9039245552411632,4.0272082760484693,4.0718766963436108,-1.9845739246594352,2.5576105574953423,-0.22856847391870841,1.1652203895037709,-4.3836248538766922,8.82564958348296,5.4441770863484997,6.5091183555182841,-8.0416918532966513,-5.0998593513480515,-0.14098367552424471,-6.3404067291794686,-3.6268496659826139,-0.96489589248915497,0.73830893808246312,3.1847787516419404,1.6843453355752622,-9.0778618730005753,-4.50588837279982,0.48919598617398247,-5.545854375189764,-2.4572513648651668,2.1238554648413559,7.8687107391603384,-5.0455931152170175,0.16545562325169139,-5.3054504479922073,-0.053065870227709595,1.3693751462928405,2.7771839381120729,4.2923243141036043,-0.23963054705381404,4.7451010917130469,-1.1099414914175985,5.1964805408639396,12.686430175405917,2.0908585152473531,-0.32926486733171978,-1.2379122340983493,-4.4602097162659069,4.5748148124144707,3.2358216254081102,-6.6941739026903457,10.012544022752142,6.7353166285898602,1.5329719697030444,-4.2677236304491331,1.8828598170031252,-0.78896755054865308,-7.0984242539751898,-6.9943196155706637,-3.6560118987859025,-0.37929071060736608,-1.0157613983551663,-6.7490268732925802,12.06249319866755,-3.4256655988128841,-5.7060447936414089,1.6208500579740273,-1.0447145346883531,-5.9481717740498228,3.6518580101851765,-2.7944842707135238],"z":[9.8501518827623737,12.212645588258463,15.716063589866415,16.348537100595834,14.668414872607762,17.824188881473837,-4.130955054895777,12.838375035551078,0.76165081253557676,13.152684795347781,12.223884657162733,11.466003691629165,8.2939416150766583,-0.47235805601363223,13.195960300820593,13.943140048100133,12.238893108894175,0.099864990713857682,8.2706743712043078,16.71441045087354,27.579693677552655,10.18429679297811,4.8222773611795517,8.6015517885470167,9.8587917497864996,6.1198280545438131,6.19558305494796,7.5047192009761963,20.959822143285336,14.134174241360116,10.400874544759946,1.9169383978899766,5.4644595810017869,8.5727731163010183,14.275517793610689,7.4753396485243133,8.6714066924082918,-4.1344516374554745,8.0794351034963068,10.490397600124791,8.9020611923243429,10.439295321809244,8.7605115745068129,18.714228450907928,12.494830206693424,7.4348321679764258,14.821026961977482,12.776648172077367,2.779180560096143,4.8342232023631571,17.899559626378124,6.4321263410198659,12.014823099065568,13.491937047949838,8.9434011007408412,-3.5147252160944928,9.3379256551419765,12.333802435767069,12.368793762733219,10.988581184624614,15.887315898813533,5.5248493583930181,4.7658528371636244,6.1493671480189915,13.300635339680277,13.439250248820578,21.447519749223584,11.42868525853731,9.5800736619378579,14.128575156000156,-0.9622530961822815,6.9798053330298213,18.313622912183735,12.722391038896456,11.742195487728658,4.2502543480897437,12.145573872755165,17.305593888998089,17.337428410092041,5.0575001722073871,15.982436101152985,16.392909185211877,-1.7161830744010151,8.330502979144196,10.005175293660233,3.3955478946485593,5.5984768577242345,5.5493955021576662,7.4215173088429927,15.073945287661893,6.0727302739245603,-3.9867177370122442,21.088452959556015,3.2602160983793627,3.9517427988390335,22.296704786336846,7.6881813078396739,-2.2396574499472051,4.4866087503976866,8.0271791719963339],"type":"scatter3d","mode":"markers","marker":{"color":"blue","size":5,"line":{"color":"rgba(31,119,180,1)"}},"name":"Data Points","error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"frame":null},{"colorbar":{"title":"","ticklen":2},"colorscale":[[0,"red"],[1,"pink"]],"showscale":false,"z":[[-9.0107443166754351,-7.7308321799699957,-6.4509200432645555,-5.1710079065591144,-3.8910957698536746,-2.6111836331482343,-1.3312714964427943,-0.051359359737353158,1.2285527769680862,2.5084649136735253,3.7883770503789664,5.0682891870844076,6.3482013237898469,7.6281134604952863,8.9080255972007283,10.187937733906168,11.467849870611607,12.747762007317046,14.027674144022486,15.307586280727929],[-8.2158190928163499,-6.9359069561109106,-5.6559948194054703,-4.3760826827000292,-3.0961705459945894,-1.8162584092891494,-0.53634627258370915,0.74356586412173198,2.0234780008271711,3.3033901375326105,4.5833022742380516,5.8632144109434927,7.1431265476489321,8.4230386843543705,9.7029508210598134,10.982862957765253,12.262775094470692,13.542687231176131,14.822599367881571,16.102511504587014],[-7.4208938689572648,-6.1409817322518254,-4.8610695955463852,-3.5811574588409436,-2.3012453221355043,-1.0213331854300642,0.25857895127537606,1.5384910879808171,2.8184032246862563,4.0983153613916956,5.3782274980971367,6.6581396348025779,7.9380517715080172,9.2179639082134557,10.497876044918899,11.777788181624338,13.057700318329777,14.337612455035217,15.617524591740656,16.897436728446099],[-6.6259686450981805,-5.3460565083927412,-4.0661443716873009,-2.7862322349818593,-1.50632009827642,-0.22640796157097989,1.0535041751344603,2.3334163118399016,3.6133284485453405,4.8932405852507799,6.173152721956221,7.4530648586616621,8.7329769953671015,10.012889132072541,11.292801268777984,12.572713405483423,13.852625542188862,15.132537678894302,16.412449815599739,17.692361952305184],[-5.8310434212390954,-4.551131284533656,-3.2712191478282153,-1.9913070111227742,-0.71139487441733495,0.56851726228810529,1.8484293989935454,3.1283415356989868,4.4082536724044257,5.688165809109865,6.9680779458153062,8.2479900825207473,9.5279022192261866,10.807814355931626,12.087726492637069,13.367638629342508,14.647550766047948,15.927462902753387,17.207375039458825,18.487287176164269],[-5.0361181973800102,-3.7562060606745713,-2.4762939239691302,-1.196381787263689,0.08353034944175021,1.3634424861471903,2.6433546228526308,3.9232667595580719,5.2031788962635108,6.4830910329689502,7.7630031696743913,9.0429153063798324,10.322827443085272,11.602739579790711,12.882651716496154,14.162563853201593,15.442475989907033,16.722388126612472,18.00230026331791,19.282212400023354],[-4.2411929735209259,-2.961280836815487,-1.6813687001100459,-0.40145656340460484,0.87845557330083446,2.1583677100062748,3.438279846711715,4.7181919834171557,5.9981041201225951,7.2780162568280344,8.5579283935334765,9.8378405302389176,11.117752666944357,12.397664803649795,13.677576940355237,14.957489077060677,16.237401213766116,17.517313350471557,18.797225487176995,20.077137623882439],[-3.4462677496618412,-2.1663556129564019,-0.88644347625096076,0.39346866045448031,1.6733807971599197,2.95329293386536,4.2332050705707998,5.5131172072762409,6.7930293439816802,8.0729414806871205,9.3528536173925616,10.632765754098003,11.912677890803442,13.19259002750888,14.472502164214323,15.752414300919762,17.032326437625201,18.312238574330642,19.59215071103608,20.872062847741525],[-2.6513425258027561,-1.3714303890973167,-0.091518252391875624,1.1883938843135655,2.4683060210190049,3.7482181577244451,5.0281302944298849,6.308042431135326,7.5879545678407654,8.8678667045462056,10.147778841251647,11.427690977957088,12.707603114662527,13.987515251367965,15.267427388073408,16.547339524778849,17.827251661484286,19.107163798189728,20.387075934895165,21.66698807160061],[-1.8564173019436709,-0.57650516523823159,0.70340697146720954,1.9833191081726507,3.26323124487809,4.5431433815835298,5.8230555182889701,7.1029676549944112,8.3828797916998514,9.6627919284052908,10.942704065110732,12.222616201816173,13.502528338521612,14.78244047522705,16.062352611932493,17.342264748637934,18.622176885343372,19.902089022048813,21.18200115875425,22.461913295459695],[-1.0614920780845858,0.21842005862085356,1.4983321953262947,2.7782443320317358,4.0581564687371747,5.338068605442615,6.6179807421480552,7.8978928788534963,9.1778050155589366,10.457717152264376,11.737629288969817,13.017541425675258,14.297453562380698,15.577365699086135,16.857277835791578,18.137189972497019,19.417102109202457,20.697014245907898,21.976926382613335,23.25683851931878],[-0.26656685422550058,1.0133452824799387,2.2932574191853798,3.573169555890821,4.8530816925962599,6.1329938293017001,7.4129059660071404,8.6928181027125824,9.9727302394180217,11.252642376123461,12.532554512828902,13.812466649534343,15.092378786239783,16.372290922945222,17.652203059650663,18.932115196356104,20.212027333061542,21.491939469766983,22.771851606472421,24.051763743177865],[0.52835836963358462,1.8082705063390239,3.088182643044465,4.3680947797499057,5.648006916455345,6.9279190531607853,8.2078311898662264,9.4877433265716675,10.767655463277107,12.047567599982546,13.327479736687987,14.607391873393428,15.887304010098868,17.167216146804307,18.447128283509748,19.727040420215189,21.006952556920627,22.286864693626068,23.566776830331506,24.84668896703695],[1.3232835934926697,2.603195730198109,3.8831078669035501,5.1630200036089908,6.4429321403144302,7.7228442770198704,9.0027564137253115,10.282668550430753,11.562580687136192,12.842492823841631,14.122404960547073,15.402317097252514,16.682229233957951,17.962141370663392,19.242053507368833,20.521965644074275,21.801877780779712,23.081789917485153,24.361702054190591,25.641614190896036],[2.1182088173517548,3.3981209540571942,4.6780330907626348,5.957945227468076,7.2378573641735153,8.5177695008789556,9.7976816375843967,11.077593774289838,12.357505910995277,13.637418047700717,14.917330184406158,16.197242321111599,17.477154457817036,18.757066594522477,20.036978731227919,21.31689086793336,22.596803004638797,23.876715141344238,25.156627278049676,26.436539414755121],[2.91313404121084,4.1930461779162798,5.47295831462172,6.7528704513271611,8.0327825880326014,9.3126947247380407,10.592606861443482,11.872518998148923,13.152431134854362,14.432343271559802,15.712255408265243,16.992167544970684,18.272079681676122,19.551991818381563,20.831903955087004,22.111816091792445,23.391728228497882,24.671640365203324,25.951552501908761,27.231464638614206],[3.7080592650699233,4.9879714017753631,6.2678835384808034,7.5477956751862445,8.8277078118916847,10.107619948597124,11.387532085302565,12.667444222008006,13.947356358713446,15.227268495418885,16.507180632124324,17.787092768829766,19.067004905535207,20.346917042240644,21.626829178946089,22.906741315651526,24.186653452356968,25.466565589062405,26.746477725767846,28.026389862473287],[4.5029844889290089,5.7828966256344483,7.0628087623398885,8.3427208990453305,9.6226330357507699,10.902545172456209,12.18245730916165,13.462369445867091,14.742281582572531,16.022193719277968,17.30210585598341,18.582017992688851,19.861930129394292,21.141842266099729,22.421754402805174,23.701666539510612,24.981578676216053,26.26149081292149,27.541402949626931,28.821315086332373],[5.2979097127880941,6.5778218494935334,7.8577339861989737,9.1376461229044157,10.417558259609855,11.697470396315294,12.977382533020736,14.257294669726177,15.537206806431616,16.817118943137054,18.097031079842495,19.376943216547936,20.656855353253377,21.936767489958815,23.216679626664259,24.496591763369697,25.776503900075138,27.056416036780575,28.336328173486017,29.616240310191458],[6.0928349366471792,7.3727470733526186,8.6526592100580597,9.9325713467635008,11.21248348346894,12.49239562017438,13.772307756879821,15.052219893585262,16.332132030290701,17.612044166996139,18.89195630370158,20.171868440407021,21.451780577112462,22.7316927138179,24.011604850523344,25.291516987228782,26.571429123934223,27.851341260639661,29.131253397345102,30.411165534050543]],"type":"surface","x":[-11.27540444842645,-9.8657296093103266,-8.4560547701942035,-7.0463799310780812,-5.6367050919619581,-4.227030252845835,-2.8173554137297128,-1.4076805746135896,0.0019942645025334826,1.4116691036186566,2.8213439427347797,4.2310187818509029,5.6406936209670242,7.0503684600831491,8.4600432991992705,9.8697181383153954,11.279392977431517,12.689067816547638,14.098742655663763,15.508417494779883],"y":[-12.635678502915102,-11.377263282294191,-10.118848061673278,-8.8604328410523649,-7.6020176204314538,-6.3436023998105417,-5.0851871791896297,-3.8267719585687168,-2.5683567379478056,-1.3099415173268945,-0.051526296705981522,1.2068889239149314,2.4653041445358426,3.7237193651567537,4.9821345857776684,6.2405498063985796,7.4989650270194907,8.7573802476404019,10.015795468261313,11.274210688882228],"opacity":0.69999999999999996,"name":"Fitted Plane","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<p>This is, of course, a very idealized situation. There is no curvature in the plane,
no interaction, no outliers, no heteroscadasticity. It’s the simplest case of multiple regression
with 2 predictors. Reality is - usually - more complicated.</p>
<p>Let’s look at summary output and check model assumptions:</p>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="multiple-linear-regression.html#cb109-1" tabindex="-1"></a><span class="fu">summary</span>(m4<span class="fl">.3</span>)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = Y ~ X1 + X2, data = d)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -4.8674 -1.3924  0.0682  1.7914  4.9145 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 10.19906    0.21844   46.69   &lt;2e-16 ***
## X1           0.56391    0.04348   12.97   &lt;2e-16 ***
## X2           1.01708    0.04507   22.57   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 2.169 on 97 degrees of freedom
## Multiple R-squared:  0.8801, Adjusted R-squared:  0.8776 
## F-statistic:   356 on 2 and 97 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="multiple-linear-regression.html#cb111-1" tabindex="-1"></a><span class="fu">check_model</span>(m4<span class="fl">.3</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-61-1.png" width="672" /></p>
<p>We could repeat this simulation to get a feeling for the variability.
The posterior predictive checks look nice. In this case, we <em>know</em> that the model is true
and with this knowledge we can assess the diagnostic plots in front of us.</p>
</div>
<div id="interaction-term-x_1-times-x_2" class="section level3 hasAnchor" number="4.2.3">
<h3><span class="header-section-number">4.2.3</span> Interaction term <span class="math inline">\(X_1 \times X_2\)</span><a href="multiple-linear-regression.html#interaction-term-x_1-times-x_2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>I recommend reading the excellent explanations about interactions
in John Kruschke’s book <a href="https://nyu-cdsc.github.io/learningr/assets/kruschke_bayesian_in_R.pdf">Doing Bayesian Data Analysis</a>,
15.2.2 und 15.2.3. Peter Westfall also has a nice explanation in his <a href="https://www.routledge.com/Understanding-Regression-Analysis-A-Conditional-Distribution-Approach/Westfall-Arias/p/book/9780367493516?srsltid=AfmBOore3O_Ciecl0TTkr9AjPIY1d6OmbQa7o7IAdKpTSkD8s9HkwzD4">book</a>
in section 9.3.</p>
<p>Our statistical model is now:</p>
<p><span class="math display">\[ Y_i = \beta_0 + \beta_1 X_{1i} + \beta_2 X_{2i} + \beta_3 X_{1i} \times X_{2i} + \varepsilon_i\]</span>
<span class="math display">\[ \varepsilon_i \sim N(0, \sigma^2)\]</span>
<span class="math display">\[ \mathbb{E}(Y_i|X_1 = x_1; X_2 = x_2) = \beta_0 + beta_1 x_{1} + beta_2 x_{2} + \beta_3 x_{1} \times x_{2}\]</span>
<span class="math display">\[ i = 1 \ldots n\]</span></p>
<p>for example:</p>
<p><span class="math display">\[ Y_i = 10 + 0.5 \cdot X_{1i} + 1 \cdot X_{2i} + 0.89 \cdot X_{1i} \cdot X_{2i} + \varepsilon_i\]</span>
<span class="math display">\[ \varepsilon_i \sim N(0, 5)\]</span>
<span class="math display">\[ \mathbb{E}(Y_i|X_1 = x_1; X_2 = x_2) = 10 + 0.5 x_1 + 1 x_2 + 0.89 x_1 x_2\]</span>
<span class="math display">\[ i = 1 \ldots n\]</span></p>
<p>The second equation states that the conditional expectation of <span class="math inline">\(Y\)</span> given <span class="math inline">\(X_1\)</span> and <span class="math inline">\(X_2\)</span>
is a function of <span class="math inline">\(X_1\)</span> and <span class="math inline">\(X_2\)</span> and their interaction. We are in a different situation now.
Set for instance <span class="math inline">\(x_2\)</span> to a certain value, say <span class="math inline">\(x_2 = 7\)</span>. Then the relationship (in expectation)
between <span class="math inline">\(Y\)</span> and <span class="math inline">\(X_1\)</span> is:</p>
<p><span class="math display">\[ \mathbb{E}(Y_i|X_1 = x_1; X_2 = 7) = 10 + 0.5 x_1 + 1 \cdot 7 + 0.89 x_1 \cdot 7\]</span>
<span class="math display">\[ \mathbb{E}(Y_i|X_1 = x_1; X_2 = 7) = 10 + (0.5 + 0.89 \cdot \mathbf{7}) \cdot x_1 + 1 \cdot 7\]</span></p>
<p>Depending on the value of <span class="math inline">\(x_2\)</span>, the <em>effect</em> of <span class="math inline">\(X_1\)</span> on <span class="math inline">\(Y\)</span> changes.
Hence, <span class="math inline">\(X_2\)</span> <strong>modifies</strong> the relationship between <span class="math inline">\(X_1\)</span> and <span class="math inline">\(Y\)</span>, states otherwise,
<span class="math inline">\(X_1\)</span> and <span class="math inline">\(X_2\)</span> <strong>interact</strong> with respect to <span class="math inline">\(Y\)</span>. Remember, the word <em>effect</em> is
used in a strictly technical/statistical sense and <strong>not in a causal</strong> sense.
It does not mean that if we <em>do</em> change <span class="math inline">\(X_1\)</span> by one unit,
<span class="math inline">\(Y\)</span> will also change in an experiment. We are purely describing the relationship
in an associative way. We will probably touch causality in a later chapter.
Bayesian statistics and causal inference are gaining popularity.</p>
<p>Let’s draw 100 points from this model, fit the model and add the plane:</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="multiple-linear-regression.html#cb112-1" tabindex="-1"></a><span class="co">#set.seed(123)</span></span>
<span id="cb112-2"><a href="multiple-linear-regression.html#cb112-2" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb112-3"><a href="multiple-linear-regression.html#cb112-3" tabindex="-1"></a>X1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">5</span>)</span>
<span id="cb112-4"><a href="multiple-linear-regression.html#cb112-4" tabindex="-1"></a>X2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">5</span>)</span>
<span id="cb112-5"><a href="multiple-linear-regression.html#cb112-5" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="sc">+</span> <span class="fl">0.5</span> <span class="sc">*</span> X1 <span class="sc">+</span> <span class="dv">1</span> <span class="sc">*</span> X2 <span class="sc">+</span> <span class="fl">0.89</span> <span class="sc">*</span> X1 <span class="sc">*</span> X2 <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">5</span>)</span>
<span id="cb112-6"><a href="multiple-linear-regression.html#cb112-6" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">X1 =</span> X1, <span class="at">X2 =</span> X2, <span class="at">Y =</span> Y)</span>
<span id="cb112-7"><a href="multiple-linear-regression.html#cb112-7" tabindex="-1"></a></span>
<span id="cb112-8"><a href="multiple-linear-regression.html#cb112-8" tabindex="-1"></a><span class="co"># Fit the model</span></span>
<span id="cb112-9"><a href="multiple-linear-regression.html#cb112-9" tabindex="-1"></a>m4<span class="fl">.4</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y <span class="sc">~</span> X1 <span class="sc">*</span> X2, <span class="at">data =</span> d)</span>
<span id="cb112-10"><a href="multiple-linear-regression.html#cb112-10" tabindex="-1"></a><span class="fu">summary</span>(m4<span class="fl">.4</span>)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = Y ~ X1 * X2, data = d)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -12.193  -3.064   0.056   3.365  13.162 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 10.86481    0.48835   22.25  &lt; 2e-16 ***
## X1           0.67973    0.09402    7.23 1.16e-10 ***
## X2           1.13120    0.08732   12.96  &lt; 2e-16 ***
## X1:X2        0.89915    0.01606   55.99  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 4.872 on 96 degrees of freedom
## Multiple R-squared:  0.9735, Adjusted R-squared:  0.9727 
## F-statistic:  1176 on 3 and 96 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="multiple-linear-regression.html#cb114-1" tabindex="-1"></a><span class="co"># Create a grid for the plane</span></span>
<span id="cb114-2"><a href="multiple-linear-regression.html#cb114-2" tabindex="-1"></a>X1_grid <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(d<span class="sc">$</span>X1), <span class="fu">max</span>(d<span class="sc">$</span>X1), <span class="at">length.out =</span> <span class="dv">20</span>)</span>
<span id="cb114-3"><a href="multiple-linear-regression.html#cb114-3" tabindex="-1"></a>X2_grid <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(d<span class="sc">$</span>X2), <span class="fu">max</span>(d<span class="sc">$</span>X2), <span class="at">length.out =</span> <span class="dv">20</span>)</span>
<span id="cb114-4"><a href="multiple-linear-regression.html#cb114-4" tabindex="-1"></a>grid <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">X1 =</span> X1_grid, <span class="at">X2 =</span> X2_grid)</span>
<span id="cb114-5"><a href="multiple-linear-regression.html#cb114-5" tabindex="-1"></a></span>
<span id="cb114-6"><a href="multiple-linear-regression.html#cb114-6" tabindex="-1"></a><span class="co"># Predict the values for the grid</span></span>
<span id="cb114-7"><a href="multiple-linear-regression.html#cb114-7" tabindex="-1"></a>grid<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">predict</span>(m4<span class="fl">.4</span>, <span class="at">newdata =</span> grid)</span>
<span id="cb114-8"><a href="multiple-linear-regression.html#cb114-8" tabindex="-1"></a></span>
<span id="cb114-9"><a href="multiple-linear-regression.html#cb114-9" tabindex="-1"></a><span class="co"># Convert the grid into a matrix for the plane</span></span>
<span id="cb114-10"><a href="multiple-linear-regression.html#cb114-10" tabindex="-1"></a>plane_matrix <span class="ot">&lt;-</span> <span class="fu">matrix</span>(grid<span class="sc">$</span>Y, <span class="at">nrow =</span> <span class="fu">length</span>(X1_grid), <span class="at">ncol =</span> <span class="fu">length</span>(X2_grid))</span>
<span id="cb114-11"><a href="multiple-linear-regression.html#cb114-11" tabindex="-1"></a></span>
<span id="cb114-12"><a href="multiple-linear-regression.html#cb114-12" tabindex="-1"></a><span class="co"># Create the interactive 3D plot</span></span>
<span id="cb114-13"><a href="multiple-linear-regression.html#cb114-13" tabindex="-1"></a><span class="fu">plot_ly</span>() <span class="sc">%&gt;%</span></span>
<span id="cb114-14"><a href="multiple-linear-regression.html#cb114-14" tabindex="-1"></a>  <span class="fu">add_markers</span>(</span>
<span id="cb114-15"><a href="multiple-linear-regression.html#cb114-15" tabindex="-1"></a>    <span class="at">x =</span> d<span class="sc">$</span>X2, <span class="at">y =</span> d<span class="sc">$</span>X1, <span class="at">z =</span> d<span class="sc">$</span>Y,</span>
<span id="cb114-16"><a href="multiple-linear-regression.html#cb114-16" tabindex="-1"></a>    <span class="at">marker =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">size =</span> <span class="dv">5</span>),</span>
<span id="cb114-17"><a href="multiple-linear-regression.html#cb114-17" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">&quot;Data Points&quot;</span></span>
<span id="cb114-18"><a href="multiple-linear-regression.html#cb114-18" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb114-19"><a href="multiple-linear-regression.html#cb114-19" tabindex="-1"></a>  <span class="fu">add_surface</span>(</span>
<span id="cb114-20"><a href="multiple-linear-regression.html#cb114-20" tabindex="-1"></a>    <span class="at">x =</span> X1_grid, <span class="at">y =</span> X2_grid, <span class="at">z =</span> plane_matrix,</span>
<span id="cb114-21"><a href="multiple-linear-regression.html#cb114-21" tabindex="-1"></a>    <span class="at">colorscale =</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;pink&quot;</span>)),</span>
<span id="cb114-22"><a href="multiple-linear-regression.html#cb114-22" tabindex="-1"></a>    <span class="at">showscale =</span> <span class="cn">FALSE</span>,</span>
<span id="cb114-23"><a href="multiple-linear-regression.html#cb114-23" tabindex="-1"></a>    <span class="at">opacity =</span> <span class="fl">0.7</span>,</span>
<span id="cb114-24"><a href="multiple-linear-regression.html#cb114-24" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">&quot;Fitted Plane&quot;</span></span>
<span id="cb114-25"><a href="multiple-linear-regression.html#cb114-25" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb114-26"><a href="multiple-linear-regression.html#cb114-26" tabindex="-1"></a>  plotly<span class="sc">::</span><span class="fu">layout</span>(</span>
<span id="cb114-27"><a href="multiple-linear-regression.html#cb114-27" tabindex="-1"></a>    <span class="at">scene =</span> <span class="fu">list</span>(</span>
<span id="cb114-28"><a href="multiple-linear-regression.html#cb114-28" tabindex="-1"></a>      <span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">&quot;X1&quot;</span>),</span>
<span id="cb114-29"><a href="multiple-linear-regression.html#cb114-29" tabindex="-1"></a>      <span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">&quot;X2&quot;</span>),</span>
<span id="cb114-30"><a href="multiple-linear-regression.html#cb114-30" tabindex="-1"></a>      <span class="at">zaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">&quot;Y&quot;</span>)</span>
<span id="cb114-31"><a href="multiple-linear-regression.html#cb114-31" tabindex="-1"></a>    ),</span>
<span id="cb114-32"><a href="multiple-linear-regression.html#cb114-32" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Interactive 3D Scatterplot with Fitted Plane&quot;</span></span>
<span id="cb114-33"><a href="multiple-linear-regression.html#cb114-33" tabindex="-1"></a>  )</span></code></pre></div>
<div class="plotly html-widget html-fill-item" id="htmlwidget-164a508cfe181021024b" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-164a508cfe181021024b">{"x":{"visdat":{"e58d251d93ef":["function () ","plotlyVisDat"]},"cur_data":"e58d251d93ef","attrs":{"e58d251d93ef":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[3.9782313616002569,-1.6496562812841433,-2.4606318891023542,0.52085126860064013,3.5229078129187261,2.2570833955848997,-9.5148176819649315,3.2719062229954532,-9.2945729264324015,-3.5100963039072597,-3.1900051763443256,-1.7513313206386347,12.916539157774409,3.6752490410589402,3.163112644500111,4.4511013015988006,6.6126542372762493,-6.1744989499908689,-5.6709770888900817,-3.0400278502408651,11.977266179915063,-1.486299857976956,1.2103437104485404,-7.325929138734173,3.4570912350915539,3.5782388315002849,0.477644121172356,6.8662262747148173,-5.1390797753471551,-14.459393990788739,-2.4816074890206332,-6.074997278512706,-3.2029145132233388,-0.28183485920485568,3.7202556758127581,-4.2655353759700736,6.7568266254833951,6.3659141200134712,2.4086980179716777,6.5251919812550927,-7.1221682677041551,4.709236610969489,-1.0763401487502295,-5.1281625036366796,3.575238161656956,-9.2415999810619169,4.2338632845720445,12.768079499904612,-6.3283648170157445,-2.645799793241193,0.45235110367539699,-3.9988712022130697,2.4937730226775479,0.32930444468559728,0.60253448268528365,-6.8111375011616868,0.15546126640985447,-1.501782482415412,-0.35029053181208386,5.6601585044824319,4.6272141640638207,-9.7836622844164935,-4.1573535630719105,-6.6240772473980432,-4.8670155761639515,-5.2966538354488524,2.3768853820377132,-2.3330250138163415,-2.4856224638269655,1.9754739472874159,4.4948655611778001,1.187282242883221,-5.3923902037711846,-3.2056722293994695,-8.6905351318028288,0.16035496457436127,0.72264834649438536,-11.589310748740896,6.987020938100029,-8.469224647786163,-1.7790573245319825,5.9540241031000498,-4.5068636268145497,7.3780662671561874,7.7533662057141859,-4.5024321739255511,5.4115805177108909,13.644794373468525,6.733955680788589,-4.8023917608537419,8.6375136088848574,-1.2336427917586821,3.1251099749512306,1.65039572767764,0.98735398410933728,1.9091944529213811,-2.9247637097453678,-4.3377141956550185,-5.0271680306579665,6.8869832336062862],"y":[-0.41080753788880403,-5.0341104918916137,0.31003109800223516,8.7581641378754238,-2.0462365738005492,8.5609601520320506,-4.7263609964387738,-6.2545958080766439,5.6371064332373955,-2.2865396950126198,-2.918755559105076,-6.5733432468877222,-0.53927843040716728,-8.6292516054081183,-1.8253619371426144,2.470019385887805,-0.018300814097229893,0.78305106121603396,9.9275986039145785,1.7696684827146789,8.0333480740205214,-5.3539335209059793,8.6891728213375146,-0.66894284702209683,5.21419248954615,-3.3188451543351336,-3.8078096223078362,-6.3448621076494325,3.7446372001541843,-3.6782421430629384,2.7557935672727565,3.9682884732203769,4.0095902664923209,1.0513524837140029,-2.1399626673952996,0.69526582436910334,-11.364557249778528,1.2899048516579463,4.964268457306348,8.5055490143446431,-9.7051122571918675,-3.3030239645799577,1.3994083930945367,2.2898466054920559,8.1298089843529233,-3.7664187807313949,-5.6087143905725956,7.5507309160535119,-6.1069855824576935,-2.4791361906617948,-4.1768568236008496,0.96373436329020379,4.5821269661868973,-3.804971778982893,6.5962201266142406,14.926342003058616,0.60113113750672842,-5.6359600294516534,5.0273769382364399,-4.4976910383999424,-2.5370480647674505,8.0872116946250099,8.1651924219179843,2.1392507047453102,0.84675954133928522,1.2860049846561199,-3.6324934254189407,1.3218238553790687,3.3691112461812822,1.0411532358826974,-8.871585990340721,1.7654933971599727,12.04563698151029,-0.56209901606851842,4.8900836022369161,5.7317546835054101,-3.6883174953651876,0.029888064089815376,5.3917280559894465,-7.2746211876345468,3.4256148917359703,0.68944156681981283,2.048370369516201,-5.4548119098058914,2.0364857307432032,0.28549934588335857,5.0519921459951433,-0.85517554707783283,3.4394837043336377,-1.2166194226790146,-3.3620325126798747,-5.392896694591772,-4.9264637986950479,1.3963842631327086,-1.2474185393721031,-8.3013535576948065,5.8565946421375248,-4.5361367687162311,-7.7012279025072239,3.7933920981849836],"z":[17.529927454121257,16.390136793930441,8.0525784352530874,16.893706393548072,13.333285596265974,44.092712181455461,33.235622312224777,-8.8265455205101198,-35.206656234521937,4.2227155939695979,18.472512181920933,8.8945492121411593,25.911056717117781,-23.937330090411464,0.54891991141278229,15.271556851813465,17.19642426631993,-2.9816918370189995,-42.608115669771379,-2.1984962574694009,111.5710758820622,13.043077625279961,23.22718026254849,15.20426443870943,34.33362563090617,3.1872844605026409,11.41070665196591,-23.995641853527257,-7.4564932884513571,42.156154118459774,3.5839875846840781,-12.138267336253463,6.4733799374644825,16.029777021722687,4.4797740680082914,3.9521868114099323,-58.255666726901609,32.800091665200256,23.064025698240592,72.614487984501679,62.36039074554818,3.46441984144007,15.772147176471556,-0.97795806105694316,47.420746109713264,26.761537893325052,-11.274629109979379,114.48961428434241,23.698183510927048,20.267503565254383,2.2737391524935555,4.2239108114284019,31.446849367884074,4.7071189090087344,14.762411416862532,-84.386788618861971,7.2154709304276583,10.086697755885211,11.210627089320219,-16.565427936744364,6.7289061702938104,-71.232443807536555,-21.173706702458862,-4.8041678344273944,2.4047113969638856,0.25459061233019875,2.9023755784110841,11.869534399795779,4.9981088852183984,12.911441540430056,-32.114977774240216,18.278801950290223,-48.48856301146553,9.7866851849962853,-36.827175736236264,19.338856733623597,-0.45540696845229611,-1.3495493998293608,58.194353435472742,46.116954231763671,9.1217439205646382,20.043288337277172,-3.799888507603896,-10.299785361259664,29.255174521235219,5.0392150617963338,44.043068170284037,13.671952463021569,47.405783041697532,7.7658076862447754,-7.5917742624431872,9.6210948751779686,-9.9031836686429422,12.635465001057451,23.187985685170794,-4.4607084345500887,0.8435277158827903,26.339863545733728,37.084506053147663,50.248352154176771],"type":"scatter3d","mode":"markers","marker":{"color":"blue","size":5},"name":"Data Points","inherit":true},"e58d251d93ef.1":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"z":[[134.53607588347452,121.09450768790884,107.65293949234318,94.211371296777529,80.769803101211863,67.328234905646184,53.886666710080519,40.445098514514846,27.003530318949178,13.561962123383507,0.12039392781783839,-13.321174267747816,-26.762742463313483,-40.204310658879159,-53.645878854444824,-67.087447050010496,-80.529015245576176,-93.970583441141827,-107.41215163670751,-120.85371983227319],[117.48650916567611,105.88529668388446,94.284084202092828,82.682871720301193,71.081659238509559,59.480446756717903,47.879234274926276,36.278021793134634,24.676809311342996,13.075596829551353,1.4743843477597132,-10.126828134031914,-21.728040615823556,-33.329253097615194,-44.930465579406835,-56.53167806119847,-68.132890542990125,-79.73410302478176,-91.335315506573409,-102.93652798836506],[100.43694244787767,90.676085679860051,80.915228911842448,71.154372143824858,61.39351537580724,51.632658607789629,41.871801839772033,32.110945071754422,22.350088303736808,12.589231535719199,2.8283747677015905,-6.9324820003160061,-16.693338768333614,-26.454195536351229,-36.215052304368839,-45.97590907238645,-55.736765840404054,-65.497622608421665,-75.258479376439269,-85.019336144456901],[83.387375730079256,75.466874675835669,67.546373621592096,59.625872567348523,51.70537151310495,43.784870458861363,35.864369404617783,27.943868350374206,20.023367296130623,12.102866241887044,4.182365187643466,-3.7381358666001034,-11.658636920843685,-19.579137975087264,-27.499639029330844,-35.420140083574424,-43.340641137818004,-51.261142192061584,-59.181643246305164,-67.102144300548758],[66.337809012280829,60.257663671811279,54.17751833134173,48.097372990872188,42.017227650402639,35.937082309933082,29.856936969463543,23.77679162899399,17.696646288524441,11.616500948054892,5.5363556075853415,-0.54378973288419974,-6.6239350733537483,-12.7040804138233,-18.784225754292848,-24.864371094762401,-30.944516435231947,-37.024661775701496,-43.104807116171052,-49.184952456640602],[49.288242294482401,45.048452667786883,40.808663041091364,36.568873414395846,32.329083787700327,28.089294161004808,23.84950453430929,19.609714907613775,15.369925280918256,11.130135654222736,6.890346027527217,2.6505564008317042,-1.5892332258638158,-5.8290228525593353,-10.068812479254852,-14.308602105950371,-18.548391732645893,-22.788181359341412,-27.027970986036927,-31.267760612732452],[32.238675576683988,29.839241663762493,27.439807750841005,25.040373837919518,22.64093992499803,20.241506012076538,17.84207209915505,15.442638186233562,13.043204273312073,10.643770360390583,8.2443364474690934,5.8449025345476073,3.4454686216261172,1.046034708704628,-1.3533992042168628,-3.7528331171383504,-6.152267030059841,-8.5517009429813289,-10.951134855902822,-13.350568768824314],[15.189108858885547,14.630030659738088,14.070952460590632,13.511874261443175,12.952796062295715,12.393717863148257,11.8346396640008,11.275561464853343,10.716483265705886,10.157405066558425,9.5983268674109699,9.0392486682635127,8.4801704691160555,7.9210922699685957,7.3620140708211377,6.8029358716736805,6.2438576725262216,5.6847794733787653,5.1257012742313064,4.5666230750838483],[-1.8604578589128691,-0.5791803442862975,0.70209717034027375,1.9833746849668437,3.264652199593415,4.5459297142199873,5.8272072288465582,7.1084847434731291,8.3897622580997009,9.6710397727262727,10.952317287352844,12.233594801979415,13.514872316605986,14.796149831232558,16.077427345859128,17.358704860485698,18.639982375112272,19.921259889738842,21.202537404365412,22.483814918991989],[-18.910024576711283,-15.788391348310684,-12.666758119910083,-9.5451248915094862,-6.4234916631088845,-3.3018584347082824,-0.18022520630768404,2.9414080220929169,6.0630412504935167,9.1846744788941184,12.306307707294719,15.427940935695316,18.549574164095919,21.67120739249652,24.792840620897117,27.914473849297718,31.036107077698318,34.157740306098923,37.27937353449952,40.401006762900124],[-35.959591294509721,-30.99760235233509,-26.035613410160458,-21.07362446798583,-16.111635525811199,-11.149646583636562,-6.1876576414619331,-1.2256686992873016,3.7363202428873308,8.698309185061964,13.660298127236597,18.622287069411225,23.584276011585853,28.546264953760485,33.50825389593512,38.470242838109755,43.432231780284383,48.394220722459018,53.356209664633653,58.318198606808288],[-53.009158012308134,-46.206813356359476,-39.404468700410817,-32.602124044462158,-25.7997793885135,-18.997434732564834,-12.195090076616175,-5.3927454206675138,1.4095992352811484,8.2119438912298097,15.014288547178472,21.816633203127125,28.618977859075788,35.42132251502445,42.223667170973108,49.026011826921774,55.828356482870433,62.630701138819099,69.43304579476775,76.235390450716423],[-70.058724730106547,-61.416024360383858,-52.773323990661169,-44.130623620938493,-35.487923251215797,-26.845222881493104,-18.202522511770418,-9.559822142047727,-0.91712177232503633,7.7255785973976545,16.368278967120347,25.010979336843025,33.653679706565718,42.296380076288408,50.939080446011097,59.581780815733794,68.224481185456483,76.867181555179172,85.509881924901862,94.152582294624565],[-87.108291447904961,-76.62523536440824,-66.14217928091152,-55.659123197414814,-45.176067113918101,-34.693011030421374,-24.209954946924661,-13.726898863427939,-3.2438427799312182,7.2392133035655002,17.722269387062223,28.205325470558929,38.688381554055645,49.171437637552373,59.654493721049093,70.137549804545813,80.620605888042533,91.103661971539253,101.58671805503597,112.06977413853269],[-104.15785816570343,-91.83444636843268,-79.511034571161915,-67.187622773891178,-54.864210976620434,-42.540799179349669,-30.217387382078918,-17.893975584808167,-5.5705637875374094,6.752848009733345,19.076259807004099,31.39967160427484,43.723083401545594,56.046495198816352,68.369906996087096,80.693318793357861,93.016730590628612,105.34014238789936,117.66355418517011,129.98696598244089],[-121.20742488350184,-107.04365737245706,-92.879889861412281,-78.716122350367513,-64.552354839322717,-50.388587328277943,-36.224819817233161,-22.061052306188376,-7.8972847951435927,6.2664827159011907,20.430250226945976,34.594017737990747,48.757785249035528,62.92155276008031,77.085320271125099,91.24908778216988,105.41285529321466,119.57662280425944,133.74039031530421,147.90415782634901],[-138.25699160130026,-122.25286837648146,-106.24874515166265,-90.244621926843834,-74.240498702025022,-58.236375477206209,-42.232252252387397,-26.228129027568592,-10.224005802749776,5.7801174220690363,21.784240646887849,37.788363871706643,53.792487096525463,69.796610321344275,85.800733546163073,101.80485677098189,117.80897999580071,133.81310322061952,149.81722644543834,165.82134967025718],[-155.30655831909868,-137.46207938050583,-119.617600441913,-101.77312150332018,-83.928642564727326,-66.084163626134469,-48.239684687541647,-30.395205748948801,-12.550726810355959,5.293752128236882,23.138231066829725,40.982710005422547,58.82718894401539,76.671667882608233,94.516146821201076,112.36062575979392,130.20510469838675,148.04958363697961,165.89406257557243,183.73854151416529],[-172.35612503689708,-152.67129038453021,-132.98645573216334,-113.3016210797965,-93.616786427429631,-73.931951775062743,-54.247117122695883,-34.562282470329016,-14.877447817962143,4.8073868344047277,24.492221486771598,44.17705613913845,63.861890791505317,83.546725443872191,103.23156009623906,122.91639474860594,142.60122940097281,162.28606405333969,181.97089870570656,201.65573335807343],[-189.40569175469557,-167.88050138855468,-146.35531102241376,-124.83012065627288,-103.30493029013196,-81.779739923991045,-60.254549557850147,-38.729359191709243,-17.204168825568338,4.3210215405725707,25.846211906713478,47.371402272854361,68.896592638995273,90.421783005136177,111.94697337127708,133.47216373741799,154.99735410355891,176.5225444696998,198.04773483584071,219.57292520198166]],"type":"surface","x":[-11.364557249778528,-9.9808257101555213,-8.5970941705325128,-7.213362630909506,-5.8296310912864984,-4.4458995516634907,-3.0621680120404839,-1.6784364724174754,-0.29470493279446863,1.0890266068285381,2.4727581464515467,3.8564896860745534,5.2402212256975602,6.623952765320567,8.0076843049435773,9.3914158445665841,10.775147384189591,12.158878923812598,13.542610463435604,14.926342003058616],"y":[-14.459393990788739,-12.980226182143619,-11.5010583734985,-10.021890564853383,-8.5427227562082635,-7.0635549475631434,-5.5843871389180251,-4.1052193302729059,-2.6260515216277867,-1.1468837129826674,0.33228409566245176,1.8114519043075692,3.2906197129526884,4.7697875215978076,6.2489553302429268,7.728123138888046,9.2072909475331652,10.686458756178284,12.165626564823404,13.644794373468525],"colorscale":[[0,1],["red","pink"]],"showscale":false,"opacity":0.69999999999999996,"name":"Fitted Plane","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"scene":{"xaxis":{"title":"X1"},"yaxis":{"title":"X2"},"zaxis":{"title":"Y"}},"title":"Interactive 3D Scatterplot with Fitted Plane","hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[3.9782313616002569,-1.6496562812841433,-2.4606318891023542,0.52085126860064013,3.5229078129187261,2.2570833955848997,-9.5148176819649315,3.2719062229954532,-9.2945729264324015,-3.5100963039072597,-3.1900051763443256,-1.7513313206386347,12.916539157774409,3.6752490410589402,3.163112644500111,4.4511013015988006,6.6126542372762493,-6.1744989499908689,-5.6709770888900817,-3.0400278502408651,11.977266179915063,-1.486299857976956,1.2103437104485404,-7.325929138734173,3.4570912350915539,3.5782388315002849,0.477644121172356,6.8662262747148173,-5.1390797753471551,-14.459393990788739,-2.4816074890206332,-6.074997278512706,-3.2029145132233388,-0.28183485920485568,3.7202556758127581,-4.2655353759700736,6.7568266254833951,6.3659141200134712,2.4086980179716777,6.5251919812550927,-7.1221682677041551,4.709236610969489,-1.0763401487502295,-5.1281625036366796,3.575238161656956,-9.2415999810619169,4.2338632845720445,12.768079499904612,-6.3283648170157445,-2.645799793241193,0.45235110367539699,-3.9988712022130697,2.4937730226775479,0.32930444468559728,0.60253448268528365,-6.8111375011616868,0.15546126640985447,-1.501782482415412,-0.35029053181208386,5.6601585044824319,4.6272141640638207,-9.7836622844164935,-4.1573535630719105,-6.6240772473980432,-4.8670155761639515,-5.2966538354488524,2.3768853820377132,-2.3330250138163415,-2.4856224638269655,1.9754739472874159,4.4948655611778001,1.187282242883221,-5.3923902037711846,-3.2056722293994695,-8.6905351318028288,0.16035496457436127,0.72264834649438536,-11.589310748740896,6.987020938100029,-8.469224647786163,-1.7790573245319825,5.9540241031000498,-4.5068636268145497,7.3780662671561874,7.7533662057141859,-4.5024321739255511,5.4115805177108909,13.644794373468525,6.733955680788589,-4.8023917608537419,8.6375136088848574,-1.2336427917586821,3.1251099749512306,1.65039572767764,0.98735398410933728,1.9091944529213811,-2.9247637097453678,-4.3377141956550185,-5.0271680306579665,6.8869832336062862],"y":[-0.41080753788880403,-5.0341104918916137,0.31003109800223516,8.7581641378754238,-2.0462365738005492,8.5609601520320506,-4.7263609964387738,-6.2545958080766439,5.6371064332373955,-2.2865396950126198,-2.918755559105076,-6.5733432468877222,-0.53927843040716728,-8.6292516054081183,-1.8253619371426144,2.470019385887805,-0.018300814097229893,0.78305106121603396,9.9275986039145785,1.7696684827146789,8.0333480740205214,-5.3539335209059793,8.6891728213375146,-0.66894284702209683,5.21419248954615,-3.3188451543351336,-3.8078096223078362,-6.3448621076494325,3.7446372001541843,-3.6782421430629384,2.7557935672727565,3.9682884732203769,4.0095902664923209,1.0513524837140029,-2.1399626673952996,0.69526582436910334,-11.364557249778528,1.2899048516579463,4.964268457306348,8.5055490143446431,-9.7051122571918675,-3.3030239645799577,1.3994083930945367,2.2898466054920559,8.1298089843529233,-3.7664187807313949,-5.6087143905725956,7.5507309160535119,-6.1069855824576935,-2.4791361906617948,-4.1768568236008496,0.96373436329020379,4.5821269661868973,-3.804971778982893,6.5962201266142406,14.926342003058616,0.60113113750672842,-5.6359600294516534,5.0273769382364399,-4.4976910383999424,-2.5370480647674505,8.0872116946250099,8.1651924219179843,2.1392507047453102,0.84675954133928522,1.2860049846561199,-3.6324934254189407,1.3218238553790687,3.3691112461812822,1.0411532358826974,-8.871585990340721,1.7654933971599727,12.04563698151029,-0.56209901606851842,4.8900836022369161,5.7317546835054101,-3.6883174953651876,0.029888064089815376,5.3917280559894465,-7.2746211876345468,3.4256148917359703,0.68944156681981283,2.048370369516201,-5.4548119098058914,2.0364857307432032,0.28549934588335857,5.0519921459951433,-0.85517554707783283,3.4394837043336377,-1.2166194226790146,-3.3620325126798747,-5.392896694591772,-4.9264637986950479,1.3963842631327086,-1.2474185393721031,-8.3013535576948065,5.8565946421375248,-4.5361367687162311,-7.7012279025072239,3.7933920981849836],"z":[17.529927454121257,16.390136793930441,8.0525784352530874,16.893706393548072,13.333285596265974,44.092712181455461,33.235622312224777,-8.8265455205101198,-35.206656234521937,4.2227155939695979,18.472512181920933,8.8945492121411593,25.911056717117781,-23.937330090411464,0.54891991141278229,15.271556851813465,17.19642426631993,-2.9816918370189995,-42.608115669771379,-2.1984962574694009,111.5710758820622,13.043077625279961,23.22718026254849,15.20426443870943,34.33362563090617,3.1872844605026409,11.41070665196591,-23.995641853527257,-7.4564932884513571,42.156154118459774,3.5839875846840781,-12.138267336253463,6.4733799374644825,16.029777021722687,4.4797740680082914,3.9521868114099323,-58.255666726901609,32.800091665200256,23.064025698240592,72.614487984501679,62.36039074554818,3.46441984144007,15.772147176471556,-0.97795806105694316,47.420746109713264,26.761537893325052,-11.274629109979379,114.48961428434241,23.698183510927048,20.267503565254383,2.2737391524935555,4.2239108114284019,31.446849367884074,4.7071189090087344,14.762411416862532,-84.386788618861971,7.2154709304276583,10.086697755885211,11.210627089320219,-16.565427936744364,6.7289061702938104,-71.232443807536555,-21.173706702458862,-4.8041678344273944,2.4047113969638856,0.25459061233019875,2.9023755784110841,11.869534399795779,4.9981088852183984,12.911441540430056,-32.114977774240216,18.278801950290223,-48.48856301146553,9.7866851849962853,-36.827175736236264,19.338856733623597,-0.45540696845229611,-1.3495493998293608,58.194353435472742,46.116954231763671,9.1217439205646382,20.043288337277172,-3.799888507603896,-10.299785361259664,29.255174521235219,5.0392150617963338,44.043068170284037,13.671952463021569,47.405783041697532,7.7658076862447754,-7.5917742624431872,9.6210948751779686,-9.9031836686429422,12.635465001057451,23.187985685170794,-4.4607084345500887,0.8435277158827903,26.339863545733728,37.084506053147663,50.248352154176771],"type":"scatter3d","mode":"markers","marker":{"color":"blue","size":5,"line":{"color":"rgba(31,119,180,1)"}},"name":"Data Points","error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"frame":null},{"colorbar":{"title":"","ticklen":2},"colorscale":[[0,"red"],[1,"pink"]],"showscale":false,"z":[[134.53607588347452,121.09450768790884,107.65293949234318,94.211371296777529,80.769803101211863,67.328234905646184,53.886666710080519,40.445098514514846,27.003530318949178,13.561962123383507,0.12039392781783839,-13.321174267747816,-26.762742463313483,-40.204310658879159,-53.645878854444824,-67.087447050010496,-80.529015245576176,-93.970583441141827,-107.41215163670751,-120.85371983227319],[117.48650916567611,105.88529668388446,94.284084202092828,82.682871720301193,71.081659238509559,59.480446756717903,47.879234274926276,36.278021793134634,24.676809311342996,13.075596829551353,1.4743843477597132,-10.126828134031914,-21.728040615823556,-33.329253097615194,-44.930465579406835,-56.53167806119847,-68.132890542990125,-79.73410302478176,-91.335315506573409,-102.93652798836506],[100.43694244787767,90.676085679860051,80.915228911842448,71.154372143824858,61.39351537580724,51.632658607789629,41.871801839772033,32.110945071754422,22.350088303736808,12.589231535719199,2.8283747677015905,-6.9324820003160061,-16.693338768333614,-26.454195536351229,-36.215052304368839,-45.97590907238645,-55.736765840404054,-65.497622608421665,-75.258479376439269,-85.019336144456901],[83.387375730079256,75.466874675835669,67.546373621592096,59.625872567348523,51.70537151310495,43.784870458861363,35.864369404617783,27.943868350374206,20.023367296130623,12.102866241887044,4.182365187643466,-3.7381358666001034,-11.658636920843685,-19.579137975087264,-27.499639029330844,-35.420140083574424,-43.340641137818004,-51.261142192061584,-59.181643246305164,-67.102144300548758],[66.337809012280829,60.257663671811279,54.17751833134173,48.097372990872188,42.017227650402639,35.937082309933082,29.856936969463543,23.77679162899399,17.696646288524441,11.616500948054892,5.5363556075853415,-0.54378973288419974,-6.6239350733537483,-12.7040804138233,-18.784225754292848,-24.864371094762401,-30.944516435231947,-37.024661775701496,-43.104807116171052,-49.184952456640602],[49.288242294482401,45.048452667786883,40.808663041091364,36.568873414395846,32.329083787700327,28.089294161004808,23.84950453430929,19.609714907613775,15.369925280918256,11.130135654222736,6.890346027527217,2.6505564008317042,-1.5892332258638158,-5.8290228525593353,-10.068812479254852,-14.308602105950371,-18.548391732645893,-22.788181359341412,-27.027970986036927,-31.267760612732452],[32.238675576683988,29.839241663762493,27.439807750841005,25.040373837919518,22.64093992499803,20.241506012076538,17.84207209915505,15.442638186233562,13.043204273312073,10.643770360390583,8.2443364474690934,5.8449025345476073,3.4454686216261172,1.046034708704628,-1.3533992042168628,-3.7528331171383504,-6.152267030059841,-8.5517009429813289,-10.951134855902822,-13.350568768824314],[15.189108858885547,14.630030659738088,14.070952460590632,13.511874261443175,12.952796062295715,12.393717863148257,11.8346396640008,11.275561464853343,10.716483265705886,10.157405066558425,9.5983268674109699,9.0392486682635127,8.4801704691160555,7.9210922699685957,7.3620140708211377,6.8029358716736805,6.2438576725262216,5.6847794733787653,5.1257012742313064,4.5666230750838483],[-1.8604578589128691,-0.5791803442862975,0.70209717034027375,1.9833746849668437,3.264652199593415,4.5459297142199873,5.8272072288465582,7.1084847434731291,8.3897622580997009,9.6710397727262727,10.952317287352844,12.233594801979415,13.514872316605986,14.796149831232558,16.077427345859128,17.358704860485698,18.639982375112272,19.921259889738842,21.202537404365412,22.483814918991989],[-18.910024576711283,-15.788391348310684,-12.666758119910083,-9.5451248915094862,-6.4234916631088845,-3.3018584347082824,-0.18022520630768404,2.9414080220929169,6.0630412504935167,9.1846744788941184,12.306307707294719,15.427940935695316,18.549574164095919,21.67120739249652,24.792840620897117,27.914473849297718,31.036107077698318,34.157740306098923,37.27937353449952,40.401006762900124],[-35.959591294509721,-30.99760235233509,-26.035613410160458,-21.07362446798583,-16.111635525811199,-11.149646583636562,-6.1876576414619331,-1.2256686992873016,3.7363202428873308,8.698309185061964,13.660298127236597,18.622287069411225,23.584276011585853,28.546264953760485,33.50825389593512,38.470242838109755,43.432231780284383,48.394220722459018,53.356209664633653,58.318198606808288],[-53.009158012308134,-46.206813356359476,-39.404468700410817,-32.602124044462158,-25.7997793885135,-18.997434732564834,-12.195090076616175,-5.3927454206675138,1.4095992352811484,8.2119438912298097,15.014288547178472,21.816633203127125,28.618977859075788,35.42132251502445,42.223667170973108,49.026011826921774,55.828356482870433,62.630701138819099,69.43304579476775,76.235390450716423],[-70.058724730106547,-61.416024360383858,-52.773323990661169,-44.130623620938493,-35.487923251215797,-26.845222881493104,-18.202522511770418,-9.559822142047727,-0.91712177232503633,7.7255785973976545,16.368278967120347,25.010979336843025,33.653679706565718,42.296380076288408,50.939080446011097,59.581780815733794,68.224481185456483,76.867181555179172,85.509881924901862,94.152582294624565],[-87.108291447904961,-76.62523536440824,-66.14217928091152,-55.659123197414814,-45.176067113918101,-34.693011030421374,-24.209954946924661,-13.726898863427939,-3.2438427799312182,7.2392133035655002,17.722269387062223,28.205325470558929,38.688381554055645,49.171437637552373,59.654493721049093,70.137549804545813,80.620605888042533,91.103661971539253,101.58671805503597,112.06977413853269],[-104.15785816570343,-91.83444636843268,-79.511034571161915,-67.187622773891178,-54.864210976620434,-42.540799179349669,-30.217387382078918,-17.893975584808167,-5.5705637875374094,6.752848009733345,19.076259807004099,31.39967160427484,43.723083401545594,56.046495198816352,68.369906996087096,80.693318793357861,93.016730590628612,105.34014238789936,117.66355418517011,129.98696598244089],[-121.20742488350184,-107.04365737245706,-92.879889861412281,-78.716122350367513,-64.552354839322717,-50.388587328277943,-36.224819817233161,-22.061052306188376,-7.8972847951435927,6.2664827159011907,20.430250226945976,34.594017737990747,48.757785249035528,62.92155276008031,77.085320271125099,91.24908778216988,105.41285529321466,119.57662280425944,133.74039031530421,147.90415782634901],[-138.25699160130026,-122.25286837648146,-106.24874515166265,-90.244621926843834,-74.240498702025022,-58.236375477206209,-42.232252252387397,-26.228129027568592,-10.224005802749776,5.7801174220690363,21.784240646887849,37.788363871706643,53.792487096525463,69.796610321344275,85.800733546163073,101.80485677098189,117.80897999580071,133.81310322061952,149.81722644543834,165.82134967025718],[-155.30655831909868,-137.46207938050583,-119.617600441913,-101.77312150332018,-83.928642564727326,-66.084163626134469,-48.239684687541647,-30.395205748948801,-12.550726810355959,5.293752128236882,23.138231066829725,40.982710005422547,58.82718894401539,76.671667882608233,94.516146821201076,112.36062575979392,130.20510469838675,148.04958363697961,165.89406257557243,183.73854151416529],[-172.35612503689708,-152.67129038453021,-132.98645573216334,-113.3016210797965,-93.616786427429631,-73.931951775062743,-54.247117122695883,-34.562282470329016,-14.877447817962143,4.8073868344047277,24.492221486771598,44.17705613913845,63.861890791505317,83.546725443872191,103.23156009623906,122.91639474860594,142.60122940097281,162.28606405333969,181.97089870570656,201.65573335807343],[-189.40569175469557,-167.88050138855468,-146.35531102241376,-124.83012065627288,-103.30493029013196,-81.779739923991045,-60.254549557850147,-38.729359191709243,-17.204168825568338,4.3210215405725707,25.846211906713478,47.371402272854361,68.896592638995273,90.421783005136177,111.94697337127708,133.47216373741799,154.99735410355891,176.5225444696998,198.04773483584071,219.57292520198166]],"type":"surface","x":[-11.364557249778528,-9.9808257101555213,-8.5970941705325128,-7.213362630909506,-5.8296310912864984,-4.4458995516634907,-3.0621680120404839,-1.6784364724174754,-0.29470493279446863,1.0890266068285381,2.4727581464515467,3.8564896860745534,5.2402212256975602,6.623952765320567,8.0076843049435773,9.3914158445665841,10.775147384189591,12.158878923812598,13.542610463435604,14.926342003058616],"y":[-14.459393990788739,-12.980226182143619,-11.5010583734985,-10.021890564853383,-8.5427227562082635,-7.0635549475631434,-5.5843871389180251,-4.1052193302729059,-2.6260515216277867,-1.1468837129826674,0.33228409566245176,1.8114519043075692,3.2906197129526884,4.7697875215978076,6.2489553302429268,7.728123138888046,9.2072909475331652,10.686458756178284,12.165626564823404,13.644794373468525],"opacity":0.69999999999999996,"name":"Fitted Plane","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div id="exercises-2" class="section level2 hasAnchor" number="4.3">
<h2><span class="header-section-number">4.3</span> Exercises<a href="multiple-linear-regression.html#exercises-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="exercise1_multiple_regression" class="section level3 hasAnchor" number="4.3.1">
<h3><span class="header-section-number">4.3.1</span> [M] Exercise 1<a href="multiple-linear-regression.html#exercise1_multiple_regression" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>Fit a model with a cubic term for weight and height of the !Kung San people.</li>
<li>Add the prediction bands as seen in the book.</li>
<li>Come up with an explanation for the functional form of this relationship.</li>
<li>Could there be reasons to for taking a less complicated model
(<a href="https://en.wikipedia.org/wiki/Statistical_model_specification">1</a>, <a href="https://en.wikipedia.org/wiki/Occam%27s_razor">2</a>)?</li>
</ul>
</div>
<div id="exercise2_multiple_regression" class="section level3 hasAnchor" number="4.3.2">
<h3><span class="header-section-number">4.3.2</span> [E] Exercise 2<a href="multiple-linear-regression.html#exercise2_multiple_regression" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Consider the model equations from <a href="multiple-linear-regression.html#adding_transformed_predictor">above</a>
where we used polynomial regression to model the relationship between
weight and height:</p>
<ul>
<li>Draw the model hierarchy for the model.</li>
</ul>
</div>
</div>
<div id="todos" class="section level2 hasAnchor" number="4.4">
<h2><span class="header-section-number">4.4</span> TODOS<a href="multiple-linear-regression.html#todos" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>If you add a lot of variables to your regression model, you can get an arbitrarily large (<span class="math inline">\(\le 1\)</span>)
<span class="math inline">\(R^2\)</span>. We will verify this when we have more than 2 explanatory variables.</li>
<li>maybe create animation of points wiggling to get a feeling for the variability</li>
<li>Show by simulation what Gelman talks about with significant p values. So I scan the data
for significant p values and then simulate data with the same effect size and see how often
I get significant p values. Especially the next effect would be probably smaller,
especially, if one did p-hacking! Calculate a priori probability for replication (def?).</li>
<li>For multiple regression:
We could also look at the simple regression problem as fitting a plane to the data,
as is done <a href="https://rpubs.com/pjozefek/576206">here</a> or
<a href="https://www.sthda.com/english/wiki/scatterplot3d-3d-graphics-r-software-and-data-visualization">here</a>
at the end.</li>
<li>Variability of confidence interval borders</li>
<li>Chapter: Sample size calculations for logistic and multivariate regression, Proportions, ICCs, t.test</li>
<li>Chapter about ICCs, but maybe reduced</li>
<li>clearer difference between prediction and explanation. why do we need causal inference and
why do we have to be careful when we throw predictors into a model, how sure can we be that
the model does what we want it to do?</li>
<li>simpons paradoxj</li>
<li>causal terror of richards book, fork, pipe, collider</li>
<li>Angenommen man hat ein masking eines Effekts und der Model fit ist aber gut (keine Voraussetzung verletzt),
ist diese Situation möglich?</li>
</ul>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="simple-linear-regression.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/03-Multiple_Linear_Regression.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["bookdown-demo.pdf", "bookdown-demo.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
